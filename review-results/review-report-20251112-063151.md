# Code Review Report

**Codebase**: .
**Generated**: 2025-11-12T06:31:51-06:00
**Files Reviewed**: 100
**Issues Found**: 275
**Providers**: anthropic, google, openai

---

## Summary Statistics

| Metric | Count |
|--------|-------|
| Total Files Reviewed | 100 |
| Critical Issues | 8 |
| High Priority Issues | 45 |
| Medium Priority Issues | 155 |
| Low Priority Issues | 48 |
| Informational Issues | 19 |
| **Total Issues** | **275** |

### By Category

| Category | Count |
|----------|-------|
| Security | 42 |
| Performance | 60 |
| Best Practices | 129 |
| Style | 44 |

### Provider Statistics

| Provider | Issues Found | Tokens Used | Duration |
|----------|--------------|-------------|----------|
| anthropic | 126 | 319,461 | 2m 13s |
| google | 72 | 373,383 | 8m 34s |
| openai | 77 | 264,211 | 6m 37s |

---

## Critical Issues (8)

### 1. The handleReadFile and handleWriteFile functions directly use the 'path' argument from client input without any validation or sanitization. This is a severe security vulnerability (directory traversal/arbitrary file access) as a malicious client can specify any path on the server's filesystem, leading to unauthorized reading of sensitive files (e.g., /etc/passwd, ~/.ssh/id_rsa) or writing to critical system files. ðŸ“Œ

**File**: `/Users/dshills/Development/projects/goflow/internal/testutil/testserver/main.go:204`
**Severity**: Critical
**Category**: Security
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 2. No timeout on context passed to executeWorkflow - workflow can hang indefinitely if a node blocks ðŸ“Œ

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/runtime.go:150`
**Severity**: Critical
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add context timeout based on workflow definition or configuration parameter

### 3. API mismatch: performHealthCheck calls pool.Get(ctx, serverID) and Release(serverID, client) but ConnectionPool implementation uses different signatures (Get(ctx, server *MCPServer) and Release(serverID string)). This will not compile / is a functional bug. ðŸ“Œ

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/health.go:96`
**Severity**: Critical
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Align the ConnectionPool API and callers. Either change mcp.ConnectionPool methods to match how callers use them (Get(ctx, serverID) returning protocol client) or update callers to pass the expected *MCPServer and handle the returned *PooledConnection. Ensure Release() signature matches usage and that types are consistent across packages.

### 4. The `evaluateFilter` function attempts to parse and execute filter expressions (e.g., `@.active == true`, `@.roles[*] contains 'admin'`) from user-provided JSONPath strings (`path`). This is a hand-rolled, simplistic expression evaluator that interprets user-controlled input as logic. Hand-rolled parsers and evaluators for complex languages are highly prone to security vulnerabilities such as injection attacks, logic bypasses, or unexpected behaviors if specific input is crafted to exploit parsing ambiguities or unhandled edge cases. This contrasts with `expression.go` which uses a robust and sandboxed external library (`expr-lang`) for expression evaluation. ðŸ“Œ

**File**: `/Users/dshills/Development/projects/goflow/pkg/transform/jsonpath.go:395`
**Severity**: Critical
**Category**: Security
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Do not implement custom expression evaluators for user-provided input unless absolutely necessary and with extreme care, formal language definition, and extensive security review. Instead, aim to convert JSONPath filter expressions into a format executable by a well-tested, sandboxed expression evaluator (like `expr-lang` in `expression.go`) or a robust JSONPath library that handles filtering securely. If `gjson`'s filter capabilities are insufficient, consider converting the JSON data to a Go map/struct and applying filters using standard Go logic, or a fully compliant JSONPath library that provides secure filter evaluation.

### 5. readKeyboardInput calls os.Stdin.SetReadDeadline(...) which does not exist on *os.File on all platforms and will not compile. Using SetReadDeadline on os.Stdin is incorrect; os.File does not implement net.Conn's deadline methods. ðŸ“Œ

**File**: `/Users/dshills/Development/projects/goflow/pkg/tui/app.go:218`
**Severity**: Critical
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use a proper terminal/raw input package that supports non-blocking reads (e.g., use termbox/termbox-go, golang.org/x/term, or set terminal in raw mode and use polling with select on file descriptors). Alternatively spawn a goroutine that blocks on Read and use context cancellation with os.Stdin.Close() or read from an input library that supports deadlines.

### 6. GetAllBindings uses a map keyed by Mode but attempts to insert global bindings using the string key "global" (type mismatch) which will not compile. ðŸ“Œ

**File**: `/Users/dshills/Development/projects/goflow/pkg/tui/keyboard.go:252`
**Severity**: Critical
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use a Mode value (or change the map type) for the global bindings entry. Example: add a dedicated Mode constant for global (e.g. ModeGlobal Mode = "global") or return a separate value for global bindings. Ensure map key types are consistent.

### 7. FormatByMode treats the allBindings map as if it has a string key "global" (allBindings["global"]) while the map is typed map[Mode][]*KeyBinding, causing a type-mismatch/compile-time error. ðŸ“Œ

**File**: `/Users/dshills/Development/projects/goflow/pkg/tui/keyboard_utils.go:463`
**Severity**: Critical
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use the Mode-typed key for global bindings if you intend to include them in the same map (introduce a Mode constant like ModeGlobal) or accept a separate parameter for global bindings. Keep key types consistent.

### 8. The `logBase2` helper function and the `maxEntropy` calculation within `isHighEntropyString` are mathematically incorrect. `logBase2(x)` is approximated as `x * 0.5`, and `maxEntropy` is calculated as `logBase2(length)`. Correct Shannon entropy requires `log2(probability)` and the maximum entropy for a string of length `L` from an alphabet of size `A` is `log2(A)`. This inaccuracy leads to unreliable detection of high-entropy strings, potentially missing real secrets or flagging non-secrets. ðŸ“Œ

**File**: `/Users/dshills/Development/projects/goflow/pkg/workflow/export.go:236`
**Severity**: Critical
**Category**: Security
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Correct `logBase2` to use `math.Log(x) / math.Log(2)` (or `math.Log2(x)` for Go 1.21+). Recalculate `maxEntropy` in `isHighEntropyString` using the appropriate alphabet size (e.g., 256 for bytes or the number of unique runes observed in the string). This will ensure accurate entropy calculation for more reliable secret detection.

---

## High Priority Issues (45)

### 9. getTestServerPath() uses panic() in test utility code, but callers might want to handle errors gracefully. Panics will cause entire test suite to fail.

**File**: `/Users/dshills/Development/projects/goflow/internal/testutil/testserver.go:20`
**Severity**: High
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Return error instead of panic, or provide both panicking and non-panicking versions

### 10. Scanner.Scan() reads entire lines without size limit. An extremely long line could cause memory exhaustion.

**File**: `/Users/dshills/Development/projects/goflow/internal/testutil/testserver/main.go:60`
**Severity**: High
**Category**: Security
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use io.LimitReader or set a maximum line length before scanning

### 11. The test server exposes file system operations (read_file and write_file) that read/write arbitrary paths provided by the caller, which can lead to arbitrary file disclosure or modification if untrusted inputs reach the server.

**File**: `/Users/dshills/Development/projects/goflow/internal/testutil/testserver/main.go:134`
**Severity**: High
**Category**: Security
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Restrict file access to a safe sandbox directory (e.g., a temporary test workspace) and canonicalize/validate paths to prevent directory traversal. Explicitly document that this server must only be used in trusted test environments.

### 12. Credential values are converted to Go strings and stored in memory as strings; Go strings are immutable and cannot be reliably zeroed, increasing the risk of sensitive data remaining in memory.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/credential.go:1`
**Severity**: High
**Category**: Security
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Avoid converting secret bytes to strings. Use APIs that accept []byte when possible, and keep secrets in byte slices so they can be zeroed after use. Minimize the lifetime of secret data in memory and avoid logging or storing the credential plaintext.

### 13. isOnlyWhitespace function treats invalid UTF-8 as non-whitespace, allowing potential bypass of whitespace-only validation for malformed input

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/credential.go:71`
**Severity**: High
**Category**: Security
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Validate UTF-8 encoding separately or use a more robust Unicode validation library

### 14. Password bytes are zeroed using a defer statement, but Go strings are immutable and cannot be zeroed. The credValue string created from passwordBytes cannot be securely cleared from memory.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/credential.go:143`
**Severity**: High
**Category**: Security
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Document this limitation or use a secrets management library that handles secure memory management. Consider using unsafe pointers with explicit zeroing, or accept that Go strings cannot be fully secured in memory.

### 15. In runWithInlineWatch, monitor.Subscribe() is called but the returned channel is never explicitly closed. This could cause goroutine leaks if the monitoring system doesn't clean up properly.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/run.go:227`
**Severity**: High
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Ensure the monitoring system properly cleans up channels on Unsubscribe(), or wrap the event loop in a function that ensures cleanup

### 16. Data races and unsafe concurrent writes: Get() obtains an RLock but then updates entry.AccessCount and entry.LastAccess (writes) and calls incrementHits()/incrementMisses() which mutate shared stats without acquiring the write lock.

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/cache.go:1`
**Severity**: High
**Category**: Performance
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Avoid performing writes while holding an RLock. Use proper locking (upgrade to write lock) before mutating entries or stats, or copy the entry under RLock then perform updates under a write lock. Ensure incrementHits/incrementMisses acquire the mutex or use atomic counters for stats.

### 17. Non-deterministic input hashing: hashInputs uses json.Marshal on a map which does not guarantee stable key ordering, causing identical logical inputs to hash to different values and resulting in cache misses.

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/cache.go:90`
**Severity**: High
**Category**: Performance
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Canonicalize the input map before hashing (e.g. sort keys recursively, or use a canonical JSON encoder) so serialization is deterministic. Alternatively, compute a stable hash by traversing keys in sorted order.

### 18. RWMutex held during Emit call which broadcasts to all subscribers - this can cause significant lock contention when subscribers are slow or network I/O is involved

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/cache.go:165`
**Severity**: High
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Release the read lock before emitting events, or use a non-blocking approach with a channel to notify subscribers asynchronously

### 19. Non-blocking send to buffered channel with select default will silently drop events during high load - no indication of lost events

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/events.go:275`
**Severity**: High
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Log dropped events for observability, consider metrics/monitoring, or implement a queue with backpressure or overflow handling strategy

### 20. Unsanitized variable substitution: substituteVariables injects variable values (converted via fmt.Sprintf) directly into expressions/parameters, which can lead to injection vulnerabilities depending on how substituted strings are used (e.g., passed to shell commands or remote tools).

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/node_executor.go:1`
**Severity**: High
**Category**: Security
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Treat substituted values as data, not shell code. When building commands or parameters, avoid string interpolation into shell commands. Apply escaping or use structured parameter passing APIs. Document and restrict dangerous uses.

### 21. Race condition: resultsMu is locked during BranchResult assignment but monitor.GetVariableSnapshot() is called without lock in emitNodeCompleted

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/parallel.go:125`
**Severity**: High
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Ensure consistent locking patterns around shared state access, or use atomic operations for simple fields

### 22. Partial resource cleanup on failure: connectServers registers servers and may create clients but on partial failure does not unregister servers or close already-created clients, potentially leaking processes/resources.

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/runtime.go:280`
**Severity**: High
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Implement transactional cleanup on error: when connectServers fails, iterate over already-registered servers/clients and unregister/close them. Prefer deferring cleanup as soon as resources are allocated to guarantee release on error.

### 23. Server registry not protected during concurrent access in executeNode - multiple goroutines could access registry simultaneously

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/runtime.go:281`
**Severity**: High
**Category**: Security
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add synchronization (RWMutex) around serverRegistry access, or ensure thread-safe implementation at registry level

### 24. Unbounded io.ReadAll on HTTP response bodies (sendRequest and initialize) can cause unbounded memory growth if a server returns a very large response, enabling a memory DoS.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/http_client.go:122`
**Severity**: High
**Category**: Security
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Limit the amount read from the response body by using io.LimitReader or read into a buffer with a configurable max size. Validate Content-Length (if present) before reading and return an error if it exceeds a safe threshold.

### 25. Unbounded io.ReadAll usage when reading POST responses in sendNotification/sendRequest goroutine and no limit on SSE event size in readSSEEvents; this could allow a remote server to cause large memory allocations (DoS).

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/sse_client.go:146`
**Severity**: High
**Category**: Security
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Limit reads from HTTP responses and SSE event payloads. Use io.LimitReader for HTTP responses and enforce a maximum event size when accumulating SSE event data (reject events beyond a configured size).

### 26. Using bufio.Scanner with default buffer size to parse JSON-RPC messages from stdout risks failing or truncating very long JSON messages (Scanner has a small max token size by default).

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/stdio_client.go:23`
**Severity**: High
**Category**: Security
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Replace bufio.Scanner with a bufio.Reader and a decoder (e.g., json.Decoder) or increase the Scanner buffer with Scanner.Buffer() and a sensible maximum token size. Prefer streaming decoding rather than relying on line-based splitting if message sizes may vary.

### 27. ConnectionPool uses custom bubble sort in GetFrequentServers (O(n^2)) which will be slow for large pools; additionally some stats updates occur without consistent locking or atomic operations across methods.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcpserver/connection_pool.go:20`
**Severity**: High
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use sort.Slice for efficient sorting (O(n log n)) and ensure all accesses and updates to shared stats are performed under the same mutex or using atomic operations for per-field counters to avoid races. Audit all stats updates to ensure p.mu is held when modifying shared state.

### 28. Workflow IDs are used directly to build filesystem paths without sanitization. A malicious workflow ID with path traversal characters (e.g., '../') could write/read outside the intended directory.

**File**: `/Users/dshills/Development/projects/goflow/pkg/storage/filesystem.go:15`
**Severity**: High
**Category**: Security
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Sanitize IDs before use (allow only a safe character set) or use filepath.Clean and verify the resulting path is within the baseDir. Reject IDs containing path separators or suspicious sequences.

### 29. The `exprEvaluator` struct's `programCache` (a `map[string]*vm.Program`) is accessed by `Evaluate` and `getOrCompileProgram` without any synchronization mechanism (e.g., a `sync.RWMutex`). If multiple goroutines share the same `exprEvaluator` instance, this will lead to race conditions when compiling or retrieving expressions, resulting in undefined behavior, panics, or incorrect program execution.

**File**: `/Users/dshills/Development/projects/goflow/pkg/transform/expression.go:34`
**Severity**: High
**Category**: Security
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Protect `exprEvaluator.programCache` with a `sync.RWMutex`. Acquire a read lock for cache lookups and a write lock for cache insertions.

### 30. validateExpression uses a blacklist (string matching) to block 'unsafe' patterns (e.g., os., exec., net.). Blacklists are brittle and can be bypassed (obfuscated tokens, different casing, whitespace, concatenation).

**File**: `/Users/dshills/Development/projects/goflow/pkg/transform/expression.go:41`
**Severity**: High
**Category**: Security
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Adopt a whitelist / proper sandboxing approach. Rely on the expression engine's sandboxing features or restrict the available environment/functions explicitly rather than searching for substrings. Parse the AST (if available) and inspect nodes for disallowed operations or remove/limit function registration to a minimal safe set.

### 31. Evaluate starts vm.Run in a goroutine but does not cancel/stop it if the context times out or the caller returns early. vm.Run can continue executing indefinitely, causing goroutine/resource leaks.

**File**: `/Users/dshills/Development/projects/goflow/pkg/transform/expression.go:78`
**Severity**: High
**Category**: Performance
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use an expression evaluation API that accepts a context/cancellation or run the VM in a separate process or with a cancellable mechanism. At minimum, arrange for vm.Run to observe a cancellation (if supported) or run evaluation in a worker pool with timeouts that can be forcibly terminated (e.g., run in separate process or use OS-level constraints). Avoid leaking goroutines by ensuring evaluation function returns if context is done and consider closing channels and signalling the VM to stop.

### 32. exprEvaluator.programCache (map[string]*vm.Program) is accessed and mutated without synchronization. Concurrent Evaluate calls will race on the cache leading to data races and undefined behavior.

**File**: `/Users/dshills/Development/projects/goflow/pkg/transform/expression.go:116`
**Severity**: High
**Category**: Performance
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Protect programCache with a sync.RWMutex or use sync.Map. Consider per-evaluator mutex or use singleflight to deduplicate concurrent compilations.

### 33. Many helper functions within `jsonpath.go`, such as `handleRecursiveDescentPattern`, `handleContainsFilter`, and `handleORFilter`, frequently marshal the input `data` to a JSON string (`json.Marshal`) and then unmarshal it back into an `interface{}` or parts of it. This repeated marshaling and unmarshaling process for internal data manipulation can be extremely inefficient for large JSON payloads, leading to significant performance bottlenecks and increased CPU and memory usage.

**File**: `/Users/dshills/Development/projects/goflow/pkg/transform/jsonpath.go:230`
**Severity**: High
**Category**: Performance
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Minimize redundant JSON marshaling and unmarshaling. Once data is marshaled to `jsonStr` for `gjson`, try to keep it in that format for `gjson` operations. For operations requiring `interface{}`, unmarshal once and pass the `interface{}` structure. If `gjson`'s `Result` type can be directly used for subsequent operations, leverage it to avoid full unmarshaling. A different JSONPath library might also simplify this by working directly on `interface{}` or a custom JSON AST.

### 34. resolveVariable uses reflection to access struct fields and calls reflect.Value.FieldByName(...).Interface() without checking CanInterface(). Accessing unexported fields via Interface() will panic.

**File**: `/Users/dshills/Development/projects/goflow/pkg/transform/template.go:236`
**Severity**: High
**Category**: Security
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Check field.IsValid() and field.CanInterface() before calling Interface(). For unexported fields, use safe alternatives (exported getters) or return an appropriate error instead of attempting to access private fields. Wrap reflective access in recover() if you must but prefer not to access unexported fields.

### 35. Background health-check goroutine uses select { case <-ctx.Done(): ... default: s.HealthCheck() } which will always hit default immediately and call HealthCheck without honoring the timeout â€” effectively making the timeout no-op and potentially causing blocking or unintended long-running calls.

**File**: `/Users/dshills/Development/projects/goflow/pkg/tui/server_registry.go:199`
**Severity**: High
**Category**: Security
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Do not use select with a default when trying to wait for a timeout. Instead, call s.HealthCheck() in a goroutine and use a channel to signal completion; then select on either completion or ctx.Done() to enforce the timeout. Alternatively, ensure HealthCheck accepts a context or has a timeout parameter.

### 36. Several key event handlers like `testServerConnection`, `refreshServerStatus`, `connectServer`, and `disconnectServer` perform synchronous and potentially long-running operations (network requests, tool discovery). This can lead to the UI freezing and becoming unresponsive while these operations complete, degrading user experience. While the `Render` method has an `autoRefresh` goroutine, manual actions are blocking.

**File**: `/Users/dshills/Development/projects/goflow/pkg/tui/server_registry.go:344`
**Severity**: High
**Category**: Performance
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Refactor these operations to be asynchronous. Trigger them in a goroutine and update the UI (e.g., status message, server state) with progress or results via channels or callbacks. The UI thread should remain responsive to user input and redraws.

### 37. The `validateWorkflow` function relies on `strings.Split` on semicolon or newline characters to parse individual validation error messages returned as a single string from `b.workflow.Validate()`. This parsing is brittle; if the format of error messages returned by `workflow.Validate()` changes in the future, this parsing logic could break, leading to incorrect or incomplete display of validation issues to the user.

**File**: `/Users/dshills/Development/projects/goflow/pkg/tui/workflow_builder.go:328`
**Severity**: High
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Modify the `workflow.Validate()` function (in `pkg/workflow/workflow.go` or `pkg/workflow/validator.go`) to return a custom error type (e.g., `ValidationErrorList`) that holds a slice of structured `error` objects. This allows `WorkflowBuilder` to access and present individual errors robustly without relying on string parsing heuristics.

### 38. Export sanitization is insufficient: secrets can remain in values (only keys are checked), credential detection relies on brittle heuristics and a broken entropy calculation (logBase2), and deepCopy performs shallow copies of DefaultValue which can lead to original mutation/leakage.

**File**: `/Users/dshills/Development/projects/goflow/pkg/workflow/export.go:1`
**Severity**: High
**Category**: Security
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Improve sanitization by scanning both environment variable names and values for secrets (use well-tested secret-detection libraries where possible). Fix the Shannon entropy implementation (implement correct log2 and entropy computation) or remove high-entropy heuristic in favor of deterministic rules. Deep-copy DefaultValue correctly according to its concrete type (or use encoding/decoding to perform a full deep copy). Treat any detected secret as high severity and redact values (replace with placeholders) rather than only removing keys.

### 39. The `ValidateWorkflow` function collects multiple validation errors and concatenates them into a single string separated by semicolons (`errors.New(strings.Join(validationErrors, "; "))`). This approach makes it difficult for callers (especially TUI components like `WorkflowBuilder`) to programmatically parse, process, and display individual validation errors in a structured or user-friendly manner. This leads to brittle string parsing logic in the TUI layer.

**File**: `/Users/dshills/Development/projects/goflow/pkg/workflow/validator.go:472`
**Severity**: High
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Modify `ValidateWorkflow` to return a custom error type (e.g., `type WorkflowValidationErrors []error`) that implements the `error` interface. This custom error type can hold a slice of individual error messages, allowing callers to iterate through them and present them in a structured, more robust way.

### 40. The `Validate` method aggregates multiple validation errors into a single string by joining them with a semicolon. This makes it difficult for a caller (like the TUI) to programmatically parse and display individual errors. As noted in `tui/workflow_builder.go`, this leads to brittle string parsing heuristics and maintenance challenges.

**File**: `/Users/dshills/Development/projects/goflow/pkg/workflow/workflow.go:230`
**Severity**: High
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Modify `Validate` to return a custom error type (e.g., `WorkflowValidationErrors`) that exposes individual validation errors as a slice of structured errors. This would allow `WorkflowBuilder` to iterate through specific errors for display.

### 41. Race condition: GetAllHealth calls GetHealth which acquires RWMutex while already holding a read lock on hm.mu

**File**: `pkg/mcp/health.go:104`
**Severity**: High
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Avoid nested lock acquisitions. Either copy the data directly in GetAllHealth or refactor to avoid the nested call

### 42. In readSSEEvents, closing all pending request channels will panic if multiple goroutines try to send simultaneously. Should use sync.Once or atomic flag

**File**: `pkg/mcp/sse_client.go:147`
**Severity**: High
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use sync.Once to ensure channels are only closed once, or use atomic flag to prevent double-close

### 43. recordFailure function duplicates failure recording logic already present in performHealthCheck. Creates maintenance issue

**File**: `pkg/mcpserver/calltool.go:82`
**Severity**: High
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Remove recordFailure function and consolidate failure handling in performHealthCheck

### 44. markForPreWarming called from within Get method without exclusive lock. Should use callback or defer to avoid holding lock during potential I/O

**File**: `pkg/mcpserver/connection_pool.go:117`
**Severity**: High
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Defer pre-warming marking or use separate mechanism to avoid blocking Get operations

### 45. SaveVariableSnapshot is incomplete and returns error unconditionally. Blocks variable tracking functionality

**File**: `pkg/storage/sqlite.go:426`
**Severity**: High
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Complete implementation by adding execution_id to VariableSnapshot struct and implementing full save logic

### 46. Goroutine launched for every expression evaluation with channel communication. This creates unnecessary overhead for simple expressions and can lead to goroutine leaks if context cancellation doesn't work properly.

**File**: `pkg/transform/expression.go:62`
**Severity**: High
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
For simple expressions without actual timeout risk, execute directly. Only use goroutines for expressions that are known to be long-running or when a timeout is explicitly configured.

### 47. evaluateFilter function uses string splitting to parse filter expressions without proper escaping or quote handling. Could lead to incorrect filter evaluation or injection issues.

**File**: `pkg/transform/jsonpath.go:530`
**Severity**: High
**Category**: Security
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Implement a proper expression parser that respects quoted strings and escape sequences.

### 48. GetAllBindings returns references to internal maps without copying, allowing external code to modify internal state.

**File**: `pkg/tui/keyboard.go:100`
**Severity**: High
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Return copies of bindings or use read-only interfaces to prevent external modification.

### 49. Safe type conversion from uint64 to int64 attempts to check overflow, but the check logic is incomplete. pauseDiff subtraction could underflow if memStatsStart > lastMemStats.

**File**: `pkg/tui/profiler.go:280`
**Severity**: High
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use proper unsigned arithmetic or ensure memStatsStart is always <= lastMemStats.

### 50. markDirtyInternal iterates through dirtyRegions repeatedly checking intersections, creating O(nÂ²) behavior with potential excessive coalescing

**File**: `pkg/tui/renderer.go:149`
**Severity**: High
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Implement a more efficient dirty region merging algorithm, such as sorting rectangles before merging or using spatial data structures

### 51. Goroutine spawned in Render() without synchronization mechanism; server connection state may be mutated concurrently without protection

**File**: `pkg/tui/server_registry.go:0`
**Severity**: High
**Category**: Security
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add proper synchronization (channels or sync primitives) to safely handle concurrent health checks, or move health checking to a dedicated service

### 52. NextView() calls SwitchTo() after unlocking mutex, then re-locks; race condition possible between unlock and lock

**File**: `pkg/tui/views.go:131`
**Severity**: High
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Refactor to hold lock during entire operation or use different synchronization pattern

### 53. ValidateWorkflowName() and similar functions don't validate against path traversal for workflow names used in file operations

**File**: `pkg/workflow/validator.go:113`
**Severity**: High
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add comprehensive path traversal validation for any name that might be used in filesystem operations

---

## Medium Priority Issues (155)

### 54. Signal handler goroutine may block indefinitely if signal is never received. The select statement has no timeout and ctx.Done() will only trigger if cancel() is called from main execution path.

**File**: `/Users/dshills/Development/projects/goflow/cmd/goflow/main.go:22`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Consider using a WaitGroup or ensuring the signal goroutine doesn't prevent graceful shutdown. Alternatively, use signal.NotifyContext() which is cleaner.

### 55. Calling os.Exit(0) from inside a signal-handling goroutine forces immediate process termination and skips deferred cleanup in other goroutines (including main).

**File**: `/Users/dshills/Development/projects/goflow/cmd/goflow/main.go:24`
**Severity**: Medium
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Do not call os.Exit from the signal handler. Instead, call cancel() and allow main to return naturally so deferred cleanup runs. If immediate exit is needed, perform coordinated shutdown steps and then call os.Exit from main after cleanup.

### 56. The WorkflowSpec fields Servers, Nodes, and Edges are defined as []interface{}, which allows any YAML structure to pass parsing. While flexible, this prevents static type checking and comprehensive validation of the workflow's core components at the template validation stage. The current validation only checks for emptiness of Nodes.

**File**: `/Users/dshills/Development/projects/goflow/cmd/validate-template/main.go:15`
**Severity**: Medium
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 57. No explicit error handling for os.Args[1] index access - should validate length first, though os.Args is guaranteed to have at least one element (program name)

**File**: `/Users/dshills/Development/projects/goflow/cmd/validate-template/main.go:36`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Code is actually safe, but consider using cobra for consistency with other CLI commands

### 58. The registry.Get("filesystem") call ignores a potential error. If the server is not found in the registry, server will be nil, which could lead to a nil pointer dereference or other unexpected behavior when pool.Get(ctx, server) is called.

**File**: `/Users/dshills/Development/projects/goflow/examples/performance_optimization_example.go:105`
**Severity**: Medium
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 59. Using bufio.NewScanner with default buffer size can truncate large JSON-RPC messages (scanner has a ~64KB token limit).

**File**: `/Users/dshills/Development/projects/goflow/internal/testutil/testserver/main.go:36`
**Severity**: Medium
**Category**: Performance
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use bufio.Reader and json.Decoder to stream JSON input or increase the scanner buffer with scanner.Buffer when using Scanner. Prefer streaming decoders for arbitrary-size messages.

### 60. handleWriteFile writes with 0644 permissions, allowing world-readable access to written files. No permission restriction is enforced.

**File**: `/Users/dshills/Development/projects/goflow/internal/testutil/testserver/main.go:95`
**Severity**: Medium
**Category**: Security
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use more restrictive permissions (0600) or make permissions configurable

### 61. write() method ignores errors when writing responses with _ = fmt.Fprintf(). Client won't know if response failed to send, potentially causing silent failures.

**File**: `/Users/dshills/Development/projects/goflow/internal/testutil/testserver/main.go:128`
**Severity**: Medium
**Category**: Security
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Log errors or implement a proper error handling mechanism instead of silently ignoring write failures

### 62. When the --value flag is used the provided value remains in the process's command-line arguments and may be visible in process listings or shell history.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/credential.go:40`
**Severity**: Medium
**Category**: Security
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Continue warning users (as done), strongly recommend --stdin or interactive prompt. Consider refusing to accept --value unless explicitly acknowledged (e.g., --force) or providing stronger guidance in docs.

### 63. Interactive prompts read directly from os.Stdin (e.g., fmt.Fscanln(os.Stdin)) rather than cmd.InOrStdin(), making the command harder to test and potentially inconsistent with Cobra's IO handling.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/credential.go:65`
**Severity**: Medium
**Category**: Style
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use cmd.InOrStdin() / cmd.OutOrStdout() for reading/writing so the command honors injected I/O in tests and is consistent with Cobra conventions.

### 64. Credential value from stdin is trimmed of only CR/LF but user-provided whitespace within the credential value is preserved. This could lead to unexpected behavior if users include accidental spaces.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/credential.go:157`
**Severity**: Medium
**Category**: Security
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Document the trimming behavior clearly or add a confirmation step before storing

### 65. term.ReadPassword uses os.Stdin.Fd() which may fail in non-interactive environments. No fallback mechanism provided.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/credential.go:194`
**Severity**: Medium
**Category**: Security
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add error handling and fallback to reading from stdin normally in non-interactive environments, or clearly document the interactive-only requirement

### 66. credStore.List() is called but the __goflow_index__ key is filtered out manually. If index structure changes, this becomes a maintenance burden.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/credential.go:256`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add a Filter method to the credStore interface or make the index key a constant with clear documentation

### 67. repo.Close() is called with _ = repo.Close() but errors are ignored. Repository closure failure could indicate data integrity issues.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/executions.go:48`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Log or check the close error, especially in list operations where data was read

### 68. formatValue function truncates JSON output without preserving structure. Long JSON objects will be incomplete and potentially invalid.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/executions.go:154`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use JSON validation to ensure output is still valid JSON, or clearly mark truncated values

### 69. hasCredentialEnvVars checks multiple patterns with repeated string.Contains calls in nested loops. Performance could be improved with a single regex or set lookup.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/export.go:71`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Compile a regex pattern once or use a set for pattern matching instead of multiple string operations

### 70. When writing exported workflows to disk the file is created with mode 0644, which may be too permissive for artifacts that could contain sensitive references.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/export.go:86`
**Severity**: Medium
**Category**: Security
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use a more restrictive file mode (e.g., 0600) when writing files that may contain sensitive placeholders or metadata, or allow the user to opt-in to permissive permissions. Document the chosen default.

### 71. Interactive input from bufio.Reader doesn't handle EOF or errors gracefully. If input fails, error messages may not be clear.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/import.go:95`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add explicit EOF handling and more descriptive error messages for input failures

### 72. launchTUIForWorkflow creates TUI app but defers close might not execute if app.Run() blocks indefinitely

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/init.go:93`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Ensure app.Close() is called even if app.Run() panics by using a more robust cleanup pattern

### 73. In displayFollowLogs, a new SQLiteExecutionRepository is created on each ticker tick (every 500ms) inside a loop. This creates resource leaks if ticker runs for extended periods.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/logs.go:62`
**Severity**: Medium
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Create the repository once before the loop and reuse it, or implement connection pooling

### 74. repo.Close() is called but errors are ignored with _ = repo.Close(). Should log or handle potential errors.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/logs.go:73`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
At minimum, log the error or check it explicitly if it indicates a data integrity issue

### 75. displayEvent function has multiple conditional color code concatenations that could be optimized into a single formatting function

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/logs.go:120`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Create a helper function to format colored strings instead of repeating the pattern

### 76. The displayFollowLogs function uses a time.NewTicker to poll the SQLite execution repository every 500 milliseconds for updates. This polling mechanism can be inefficient for real-time log tailing, especially if the repository is frequently accessed by other processes or if events are not frequent. It generates unnecessary database read operations.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/logs.go:139`
**Severity**: Medium
**Category**: Performance
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 77. displayFollowLogs recreates and opens a storage repository on every ticker tick (every 500ms), which is expensive and may open/close DB connections repeatedly.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/logs.go:204`
**Severity**: Medium
**Category**: Performance
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Create a single repository instance outside the loop and reuse it for periodic checks. Ensure proper error handling and close the repository once when done.

### 78. initConfig creates directories with 0755 permissions, but no umask is set. Actual permissions may vary based on system umask, potentially creating world-readable sensitive directories.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/root.go:80`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Either set umask explicitly before creating directories or use more restrictive permissions (0700 for user-only access)

### 79. splitKeyValue function creates unnecessary string slices for every variable flag. Could use strings.Cut for better performance in Go 1.18+

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/run.go:104`
**Severity**: Medium
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use strings.Cut(s, "=") instead of manual loop and string slicing

### 80. ANSI escape codes are used directly in displayInlineProgress but escape sequences may not work on all terminals. No terminal capability detection.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/run.go:237`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use a library like termenv or check TERM environment variable before using ANSI codes

### 81. The runWithInlineWatch function uses a time.NewTicker to periodically poll for execution progress via monitor.GetProgress(). Similar to the logs command, this polling approach can be inefficient and might not provide truly real-time updates for highly dynamic or high-frequency events.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/run.go:269`
**Severity**: Medium
**Category**: Performance
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 82. validateServerReferences creates a map of all referenced servers but doesn't validate that server configurations in workflow actually exist. Could reference non-existent servers.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/workflow_import.go:105`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Cross-validate that referenced servers match the ServerConfigs and actual registry entries

### 83. nodeMapToNode has multiple type assertions without consistent error context. If a node is malformed, error message won't indicate which node.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/workflow_loader.go:66`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add node ID to error messages for better debugging: fmt.Errorf("node '%s': %w", id, err)

### 84. The LoadWorkflowFromFile and LoadWorkflowFromReader functions share a substantial amount of duplicated logic for parsing YAML, creating the workflow.Workflow object, converting node maps, and processing edges. This redundancy increases maintenance burden and the risk of inconsistencies if changes are made to one but not the other.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/workflow_loader.go:156`
**Severity**: Medium
**Category**: Style
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 85. NewExecutionContext returns an error in its signature but never returns a non-nil error, which is confusing API design.

**File**: `/Users/dshills/Development/projects/goflow/pkg/domain/execution/context.go:36`
**Severity**: Medium
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Remove the unused error return (change signature to (*ExecutionContext)) or implement potential failure cases and return meaningful errors.

### 86. Variable snapshots and variable history store values by reference (e.g., maps/slices) without deep-copying, so later mutations to variables may retroactively change previously recorded snapshots in the audit trail.

**File**: `/Users/dshills/Development/projects/goflow/pkg/domain/execution/context.go:56`
**Severity**: Medium
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
When creating VariableSnapshot entries and when returning history/snapshots, deep-copy values (use deepCopyValue or similar) to ensure the audit trail is immutable and cannot be changed by later modifications.

### 87. deepCopyValue function recursively copies nested structures without depth limit. Deeply nested structures could cause stack overflow.

**File**: `/Users/dshills/Development/projects/goflow/pkg/domain/execution/context.go:122`
**Severity**: Medium
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add maximum recursion depth check or use iterative copying for deeply nested structures

### 88. Start() updates StartedAt which may already be set in NewExecution - could lead to inconsistent timing

**File**: `/Users/dshills/Development/projects/goflow/pkg/domain/execution/execution.go:57`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Remove duplicate time initialization or ensure consistent timestamp semantics between creation and start

### 89. SetStatusForTest method exposes internal state mutation for testing - couples tests to implementation details

**File**: `/Users/dshills/Development/projects/goflow/pkg/domain/execution/execution.go:118`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use dependency injection or constructor parameters instead of setter methods for test setup

### 90. ExecutionError.Error() does not guard against a nil receiver; calling this method on a nil *ExecutionError will panic because it dereferences fields.

**File**: `/Users/dshills/Development/projects/goflow/pkg/domain/execution/types.go:1`
**Severity**: Medium
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Defensively handle a nil receiver in Error() (e.g., if e == nil { return "<nil>" }) to make the type safer to use with errors.Is/As and logging.

### 91. FilterEvents creates new audit trail and allocates new slice for every filter operation - inefficient for repeated filtering

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/audit.go:206`
**Severity**: Medium
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Implement lazy filtering with iterator pattern, or cache filtered results if same filter used multiple times

### 92. recalculateCounts iterates through all events on every filter - O(n) operation that could be expensive

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/audit.go:243`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Track counts incrementally during filtering instead of recalculating from scratch

### 93. deepCopyOutputs falls back to returning the original outputs on JSON marshal/unmarshal error, which can allow callers to mutate cached state and break isolation.

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/cache.go:145`
**Severity**: Medium
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Return a defensive copy (or error) instead of the original on failure. Consider alternative deep copy strategies (e.g. reflect-based copier or domain-specific cloning) and surface errors to callers if copying fails.

### 94. Statistics counters (Hits, Misses, Evictions) are modified without proper synchronization while the read lock is held in GetStats()

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/cache.go:152`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use atomic operations for all statistics counters to ensure thread-safe concurrent access without requiring locks

### 95. Cache eviction policy: Get() treats expired entries as misses but does not remove them from the map, causing stale entries to accumulate until CleanExpired runs.

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/cache.go:210`
**Severity**: Medium
**Category**: Performance
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
When an entry is found to be expired, delete it from the entries map under the write lock (or schedule asynchronous cleanup) so memory is reclaimed and stats remain accurate.

### 96. Multiple custom error types (MCPToolError, TransformError, ConditionError, etc.) that implement error interface but don't follow consistent patterns

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/error.go:1`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Create a common error wrapper interface or base type to standardize error handling across the codebase

### 97. ParseStackTrace has inconsistent trimming logic: it trims a line into 'line' but then checks prefixes against the original untrimmed lines[i], which can lead to incorrect parsing of stack traces.

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/error.go:1`
**Severity**: Medium
**Category**: Style
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use a consistent variable for inspecting lines (either use trimmed or original consistently). Add unit tests for stack trace parsing to ensure correctness across trace formats.

### 98. ParseStackTrace uses string manipulation in a loop to parse stack frames - inefficient for large stack traces

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/error.go:450`
**Severity**: Medium
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use strings.Split once and process the result more efficiently, or use runtime.Callers directly instead of parsing string output

### 99. Unsubscribe signature uses a receive-only channel type (<-chan ExecutionEvent) but compares it directly to stored bidirectional channels (sub.ch). Comparing channels of different direction types can be confusing and brittle.

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/events.go:1`
**Severity**: Medium
**Category**: Style
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use the same channel type in the API and internal storage (return the receive-only channel to callers but keep a reference to the original bidirectional channel and compare by converting or storing the receive-only version). Add tests for subscribe/unsubscribe lifecycle.

### 100. Logger methods silently fail with log.Printf but don't propagate errors - makes debugging difficult when logging fails

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/logger.go:34`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Return errors from logging methods or implement a dedicated error handler for logging failures

### 101. No maximum iteration limit - workflow could hang if collection is infinite or very large

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/loop.go:66`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add configurable max iterations limit and check total duration to prevent runaway loops

### 102. resolveVariablePath only supports nested field access for map[string]interface{} but will return an error for struct types or other containers; users may expect dot-notation to work on nested structs.

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/node_executor.go:1`
**Severity**: Medium
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Either document that only map[string]interface{} is supported or extend resolution to support struct fields (using reflection) if desired. Provide clearer error messages when access is unsupported.

### 103. Multiple error type checks using type assertion in switch statements - could be consolidated with a helper function

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/node_executor.go:110`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Create a helper function to extract error type information to reduce code duplication and improve maintainability

### 104. clearCurrentNode uses RwMutex but the check-then-set pattern is not atomic - could have TOCTOU race condition

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/progress.go:93`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Combine the check and clear into a single operation, or use atomic CAS if field can be represented atomically

### 105. Inefficient regular expression handling: matchesErrorPatterns calls regexp.MatchString in a loop which recompiles patterns on each call and is expensive.

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/retry.go:1`
**Severity**: Medium
**Category**: Performance
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Precompile regex patterns (regexp.Regexp) once and reuse them, or cache compiled regexes. Also consider avoiding regexes for simple substring checks.

### 106. calculateDelay uses math.Pow and float64 which could have precision issues - should use integer math for deterministic results

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/retry.go:66`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Implement exponential backoff using integer math or a lookup table instead of floating-point arithmetic

### 107. matchesErrorPatterns compiles regex on every call - should be pre-compiled or cached for performance

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/retry.go:148`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Pre-compile regex patterns once during initialization and cache them, or use simpler string matching for common patterns

### 108. activeClients map not cleaned up on error paths - could leak goroutines and file descriptors

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/runtime.go:385`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use defer to ensure cleanup of activeClients on all error paths

### 109. Deep copy via JSON marshaling (deepCopyVariables) is simple but can be expensive and will fail for non-JSON-serializable types (time.Time, channels, funcs), causing errors or silent nils in callers that ignore errors.

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/snapshot.go:1`
**Severity**: Medium
**Category**: Performance
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Consider a faster or more robust copy strategy for hot paths (e.g., reflection-based copy with type handling), or document and validate acceptable variable types. Surface errors instead of swallowing them.

### 110. deepCopyVariables uses JSON marshal/unmarshal for every snapshot - very expensive for large variable maps during each node execution

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/snapshot.go:107`
**Severity**: Medium
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Implement custom deep copy function that avoids JSON serialization overhead, or use reflection-based copy

### 111. applyRetentionPolicy called under write lock but performs time.Now() call which could be slow

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/snapshot.go:182`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Cache time.Now() value before acquiring lock, or perform retention policy check outside the lock

### 112. Lock held during network I/O: ConnectionPool.Get() acquires the pool write lock for the entire flow, including client creation and Connect(ctx) calls which may block for long periods and degrade concurrency.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/connection_pool.go:1`
**Severity**: Medium
**Category**: Performance
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Minimize time holding the lock: validate configuration and scan for idle connections under the lock, then release it before performing network operations (create/connect client). Re-acquire the lock only when adding the new pooled connection.

### 113. Get() holds mu.Lock for entire connection creation and Connect call - could deadlock if Connect is slow

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/connection_pool.go:115`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Release lock before calling Connect(), handle the race condition of concurrent creates separately

### 114. cleanupIdleConnections goroutine started without way to stop it - could leak if pool is not properly closed

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/connection_pool.go:180`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add a stop channel or context to the cleanup goroutine and stop it in Close()

### 115. cleanupIdleConnections holds the pool lock while closing clients (conn.Client.Close()), which may block and delay maintenance of other pool operations.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/connection_pool.go:300`
**Severity**: Medium
**Category**: Performance
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Collect connections to close while holding the lock, then close them after releasing the lock to avoid blocking other pool operations. Alternatively, perform Close in a goroutine.

### 116. The `startHealthChecks` goroutine is launched but `Stop()` does not wait for it to actually terminate. This can lead to goroutine leaks or accessing stale data if the `HealthMonitor` object is garbage collected while the goroutine is still running.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/health.go:40`
**Severity**: Medium
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add a `sync.WaitGroup` to `HealthMonitor`. Increment it before launching `startHealthChecks` and decrement in its `defer`. In `Stop()`, call `wg.Wait()` after closing the `stopChan` to ensure the goroutine has exited gracefully.

### 117. Connect() sets c.connected = true before the initialization step completes. If initialize() blocks or fails, the client may appear connected for a short time, creating a confusing state.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/http_client.go:42`
**Severity**: Medium
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Only mark the client as connected after initialize() succeeds. Hold the lock while updating state or use a two-phase approach: perform initialize, and on success set connected under lock.

### 118. The `requestIDCounter` is a global variable shared across all `HTTPClient` and `SSEClient` instances. While `atomic.AddUint64` ensures thread-safe incrementation, using a single global counter can lead to overlapping JSON-RPC request IDs if multiple client instances are active, making it difficult to uniquely match responses to requests or debug communication issues in a multi-client scenario.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/jsonrpc.go:41`
**Severity**: Medium
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
To prevent ID collisions and improve isolation, make `requestIDCounter` a field within the `HTTPClient` and `SSEClient` structs (or a dedicated factory for each client instance). Alternatively, use UUIDs for request IDs for global uniqueness and unpredictability.

### 119. Inefficient memory usage: creating strings.NewReader(string(reqJSON)) converts the []byte to string then copies to a reader, causing an extra allocation/copy.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/sse_client.go:131`
**Severity**: Medium
**Category**: Performance
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use bytes.NewReader(reqJSON) (or bytes.NewBuffer) to avoid converting the marshaled []byte to string and avoid unnecessary allocations.

### 120. Close() sets closed and closes the SSE connection body but does not wait for readSSEEvents to exit or check readerDone; possible goroutine leak or races when pendingRequests are closed in readSSEEvents.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/sse_client.go:195`
**Severity**: Medium
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
On Close(), after closing the connection body, wait for the readerDone channel or otherwise coordinate shutdown so readSSEEvents finishes before Close returns. Ensure pendingRequests are closed exactly once.

### 121. Executing user-configured commands with exec.CommandContext is inherently risky (command injection / arbitrary execution). The code has a #nosec suppression but still represents a security-sensitive operation.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/stdio_client.go:45`
**Severity**: Medium
**Category**: Security
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Ensure that commands and args are validated and come from trusted configuration files. Document the responsibility and restrict inputs where possible. Consider safer alternatives or provide explicit warnings and validation to users.

### 122. Close() (closeWithoutLock) kills the child process but does not wait for background reader goroutine (readResponses) to finish; this may lead to goroutine leaks or races on pendingRequests.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/stdio_client.go:199`
**Severity**: Medium
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Coordinate shutdown: signal the reader goroutine to stop and wait for it (e.g., via a done channel) before returning from Close(). Ensure pendingRequests channels are closed exactly once and that Close synchronizes with readResponses.

### 123. In `handleToolError`, `s.Connection.ErrorCount` is incremented, and then `s.RecordUnhealthy` is called, which also increments `s.Connection.ErrorCount`. This results in `ErrorCount` being incremented twice for a single tool invocation failure if the error is considered recoverable.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcpserver/calltool.go:134`
**Severity**: Medium
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Remove the `s.Connection.ErrorCount++` and `s.Connection.LastError = err.Error()` lines from `handleToolError` and rely solely on `s.RecordUnhealthy` (or a single consolidated helper) for updating these fields when appropriate, to ensure `ErrorCount` is incremented only once per failure.

### 124. The `GetFrequentServers` method uses a bubble sort algorithm to sort server usage, which has a time complexity of O(N^2). For a large number of monitored servers, this will become a significant performance bottleneck.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcpserver/connection_pool.go:234`
**Severity**: Medium
**Category**: Performance
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Replace the bubble sort with `sort.Slice` from the `sort` package, which uses a more efficient algorithm like quicksort or heapsort (O(N log N)).

### 125. PreWarm() collects errors into a slice and returns a combined error using fmt.Errorf with %v which loses error types and details; also PreWarm performs network/process operations while holding or frequently taking locks which may block other operations.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcpserver/connection_pool.go:240`
**Severity**: Medium
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Return a wrapped error or a structured error list (e.g., multierror) that preserves individual errors. Avoid holding long locks while performing network or process interactions; only lock to update shared state and keep critical sections minimal.

### 126. List() skips files with non-.yaml suffix but does not log why workflows that fail to load are skipped (comment says 'log error but continue' but no logging is performed).

**File**: `/Users/dshills/Development/projects/goflow/pkg/storage/filesystem.go:92`
**Severity**: Medium
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use a logger to record failures to load specific workflow files (with warning level) so operators can diagnose corrupt/invalid workflow files. Avoid silently skipping items.

### 127. Credential index stored in the system keyring is updated without synchronization; concurrent Set/Delete operations can lead to lost updates and inconsistent index state.

**File**: `/Users/dshills/Development/projects/goflow/pkg/storage/keyring.go:1`
**Severity**: Medium
**Category**: Security
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use a mutex to protect index read-modify-write sequences in addToIndex/removeFromIndex/saveIndex, or store each key as its own entry without a central index. Handle and recover from concurrent modification errors.

### 128. The `validateExpression` function uses a blacklist approach (`strings.Contains`) to detect and block unsafe operations by checking for substrings like `os.`, `exec.`, `http.`, etc. Blacklists are inherently fragile and can often be bypassed by obfuscation, encoding, or creative syntax (e.g., `o` + `s` + `.`, or using character codes). While the underlying `expr-lang` library is sandboxed, this additional string-based check might provide a false sense of security and add complexity without significantly improving actual security against determined attackers who find bypasses.

**File**: `/Users/dshills/Development/projects/goflow/pkg/transform/expression.go:95`
**Severity**: Medium
**Category**: Security
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Rely primarily on the sandboxing features of the `expr-lang` library. If additional security is absolutely required, consider a whitelist approach (only allow explicitly safe constructs) or integrate with a more robust static analysis tool specific to the expression language. Document clearly the scope and limitations of this blacklist.

### 129. validateExpression lowercases the expression then checks for patterns; however some entries (e.g., 'Get(' 'Post(') are broad and could lead to false positives or be bypassed by spacing/concatenation. Blacklisting complex function names is fragile.

**File**: `/Users/dshills/Development/projects/goflow/pkg/transform/expression.go:218`
**Severity**: Medium
**Category**: Security
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use AST-based validation, or restrict allowed functions and the evaluation environment instead of trying to detect prohibited tokens by string matching. If you must blacklist, document limitations and add robust tokenization/case handling.

### 130. convertGJSONResult converts gjson numbers to int by checking equality with float64(int64(num)). This may overflow or mis-handle large numbers (precision/overflow) and uses platform-dependent int size when casting to int.

**File**: `/Users/dshills/Development/projects/goflow/pkg/transform/jsonpath.go:152`
**Severity**: Medium
**Category**: Performance
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Consider returning int64 for whole numbers to avoid platform-dependent int size and explicitly check for overflow. Use math.Modf or integer checks with bounds and document behavior. Preserve numeric types consistently (e.g., prefer float64/json.Number) instead of converting to int implicitly.

### 131. Many filter parsing functions (evaluateFilter, convertFilters, parseFilterValue) use naive string splitting which can break on more complex expressions (strings containing operator tokens) and is fragile.

**File**: `/Users/dshills/Development/projects/goflow/pkg/transform/jsonpath.go:780`
**Severity**: Medium
**Category**: Style
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use a real parser or tokenization for filter expressions (or reuse expr-lang or another expression parser) to reliably parse operators, quoted strings and nested expressions rather than relying on strings.Split and simple substring checks.

### 132. The `TransformJSONPath`, `TransformExpression`, and `TransformTemplate` helper functions each create a *new* instance of their respective querier/evaluator/renderer (`NewJSONPathQuerier()`, `NewExpressionEvaluator()`, `NewTemplateRenderer()`) on every single call. This leads to unnecessary object creation and negates the benefits of internal caching (like `exprEvaluator.programCache`) that are present in the `Transformer` struct. This will introduce performance overhead, especially if these helper functions are called frequently.

**File**: `/Users/dshills/Development/projects/goflow/pkg/transform/transform.go:78`
**Severity**: Medium
**Category**: Performance
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
If these helper functions are intended for direct use, they should either accept a pre-initialized instance of the querier/evaluator/renderer, or reuse a singleton instance (with proper synchronization if it contains mutable state/caches). A simpler approach would be to make them methods of the `Transformer` struct, allowing them to use the already initialized and cached instances, similar to how `Transformer.Transform` works.

### 133. ToInt and ToFloat conversions truncate floats to ints without explicit rounding and do not handle many unsigned/narrow numeric types robustly; some overflow checks are fragile (comparing floats to hard int64 max/min).

**File**: `/Users/dshills/Development/projects/goflow/pkg/transform/type_conversion.go:110`
**Severity**: Medium
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Document truncation semantics clearly or perform explicit rounding where intended. Add handling for additional numeric types (uint64 etc.) and use safe range checks (avoid float comparisons for int64 bounds). Return an error for lossy conversions when appropriate.

### 134. The `readKeyboardInput` goroutine sets a read deadline on `os.Stdin` every 100 milliseconds in a tight loop. Frequently setting deadlines on I/O operations can introduce system call overhead. Additionally, if the main application loop is slow or the `inputChan` (buffered to 100) becomes full, keyboard events might be dropped due to the `default` case in the `select` statement, leading to an unresponsive user experience.

**File**: `/Users/dshills/Development/projects/goflow/pkg/tui/app.go:194`
**Severity**: Medium
**Category**: Performance
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Consider using a non-blocking input mechanism or a dedicated terminal input library that handles input more efficiently without constant deadline resets. If `os.Stdin.Read` must be used, increase the `inputChan` buffer size if input dropping is observed, or ensure the main loop processes events quickly enough. Alternatively, remove the `default` case to make the channel send blocking, which will backpressure the input goroutine, preventing dropped events at the cost of potential blocking.

### 135. The `ExecutionMonitor` calculates panel dimensions only once in its `NewExecutionMonitor` constructor using hardcoded percentages and pixel values. If the terminal window is resized after the application starts, the TUI layout will not adapt dynamically, leading to display glitches (panels overlapping, cut off, or leaving empty space).

**File**: `/Users/dshills/Development/projects/goflow/pkg/tui/execution_monitor.go:86`
**Severity**: Medium
**Category**: Performance
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Implement a mechanism to listen for terminal resize events. When a resize event occurs, recalculate the panel dimensions and trigger a re-render of the entire TUI layout. This would involve adding a resize event handler to `App` and propagating the new screen dimensions down to the `ExecutionMonitor` and its child panels.

### 136. HandleKey treats multi-key sequences by assembling string keys in a custom way that depends on event.Shift; this logic is brittle and may miss combinations (Shift handling inconsistent).

**File**: `/Users/dshills/Development/projects/goflow/pkg/tui/keyboard.go:117`
**Severity**: Medium
**Category**: Style
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Consider a clearer multi-key sequence representation (slice of KeyEvent) and consistent canonicalization (use keyEventToString for each element) for registration and matching. Add unit tests for sequences with modifiers.

### 137. The profiler's internal slices (`frameTimes`, `renderTimes`, `keyHandleTimes`, `componentTimings`) are capped by `maxFrameHistory` (default 1000) using slice truncation (`p.frameTimes = p.frameTimes[1:]`). This operation creates a new slice header and potentially re-allocates the underlying array and copies all elements `maxFrameHistory-1` times on every `EndFrame` call once the buffer is full. This constant re-allocation and copying can introduce significant overhead to the profiler itself, making it less accurate and potentially slowing down the application it's trying to profile. A ring buffer (circular queue) is a more efficient data structure for this use case.

**File**: `/Users/dshills/Development/projects/goflow/pkg/tui/profiler.go:88`
**Severity**: Medium
**Category**: Performance
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Refactor the profiling data storage from growing slices with truncation to a fixed-size ring buffer (circular queue) for `frameTimes`, `renderTimes`, `keyHandleTimes`, and `componentTimings`. This will prevent constant re-allocations and data copying, improving the profiler's performance and accuracy.

### 138. RenderComponent allocates and copies a temporary buffer for every component render using the BufferPool but does not validate rect width/height; negative or zero dimensions could cause panics or wasted allocations.

**File**: `/Users/dshills/Development/projects/goflow/pkg/tui/renderer.go:115`
**Severity**: Medium
**Category**: Performance
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Validate rect.Width and rect.Height are positive before using the buffer pool. If width/height are zero, skip rendering. Add unit tests for edge cases. Consider reusing buffers without copying where possible.

### 139. DrawText manually acquires a mutex and defers unlocking via explicit Unlock at the end rather than using defer immediately after Lock; if a panic occurs between Lock and Unlock the mutex will remain locked (deadlock).

**File**: `/Users/dshills/Development/projects/goflow/pkg/tui/renderer.go:160`
**Severity**: Medium
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use defer r.mu.Unlock() immediately after acquiring the lock to ensure the mutex is always released even if the function panics. Keep critical sections minimal.

### 140. The multi-step dialog for adding a server (`showAddServerDialog`, `showAddServerDialogStep2`, etc.) uses deeply nested callback functions. This 'callback hell' pattern makes the control flow difficult to read, understand, and maintain, especially as the number of steps or complexity of input validation increases.

**File**: `/Users/dshills/Development/projects/goflow/pkg/tui/server_registry.go:361`
**Severity**: Medium
**Category**: Style
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Consider refactoring the dialog flow using a state machine pattern, a linear sequence of prompts that blocks until input is received (if appropriate for the TUI framework), or a dedicated dialog component that manages its internal state more explicitly, reducing nesting.

### 141. showDeleteConfirmation contains confusing/duplicated control flow and creates modal confirmation twice in some code paths. The 'confirmed' variable is set inside a modal callback asynchronously but then used synchronously, leading to a logic bug where deletion may not occur as intended.

**File**: `/Users/dshills/Development/projects/goflow/pkg/tui/server_registry.go:445`
**Severity**: Medium
**Category**: Style
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Simplify flow: if an external confirmation callback is provided, use it and perform delete immediately. Otherwise, create a single modal and perform deletion inside its callback. Avoid relying on setting a local flag from an async callback and then using it immediately.

### 142. User input for server command and URL (e.g., in `showAddServerDialogStep4` and `createServerFromDialog`) is directly used to construct `mcpserver.MCPServer` objects. While the `mcpserver` package is expected to handle sanitization, direct input of commands and URLs from the user in a TUI without explicit validation or sanitization at the UI level poses a potential risk. Malicious input could lead to command injection or SSRF vulnerabilities if the underlying `mcpserver` layer is not sufficiently hardened.

**File**: `/Users/dshills/Development/projects/goflow/pkg/tui/server_registry.go:646`
**Severity**: Medium
**Category**: Security
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Implement strict input validation for the command, arguments, and URL fields in the TUI dialogs. For commands, consider allowing only whitelisted executables or very restricted formats. For URLs, validate URL schemes, hosts, and paths carefully. Ensure the `mcpserver` package has robust input sanitization and command execution safeguards (e.g., using `exec.CommandContext` with strict argument parsing, preventing shell interpretation).

### 143. The `AddNodeAtPosition` function generates a new node ID using a simple sequential approach: `fmt.Sprintf("%s-%d", ..., len(b.workflow.Nodes))`. This method does not guarantee global uniqueness across different sessions or if nodes are added and then removed. While the `workflow` package provides `workflow.NewWorkflowID()` and `workflow.NewEdgeID()` using UUIDs, `NodeID` generation is inconsistent and potentially insecure if predictable IDs are undesirable or if collisions can occur.

**File**: `/Users/dshills/Development/projects/goflow/pkg/tui/workflow_builder.go:273`
**Severity**: Medium
**Category**: Security
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add a `NewNodeID()` function to the `workflow` package (similar to `NewWorkflowID` and `NewEdgeID`) that generates a cryptographically strong UUID. Then, update `AddNodeAtPosition` and any other node creation logic to use `workflow.NewNodeID()` for robust, unique, and unpredictable ID generation.

### 144. There is a naming and architectural inconsistency: `pkg/tui/view_explorer.go` defines a placeholder `WorkflowExplorerView`, while `pkg/tui/workflow_explorer.go` defines a more functional `WorkflowExplorer`. This redundancy and ambiguous naming can lead to confusion about which component is the 'model' and which is the 'view', and how they interact. The `WorkflowExplorer` in this file also contains rendering logic, further blurring the lines.

**File**: `/Users/dshills/Development/projects/goflow/pkg/tui/workflow_explorer.go:0`
**Severity**: Medium
**Category**: Style
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Refactor the TUI view architecture. Rename `WorkflowExplorer` (this file) to `WorkflowExplorerModel` or similar to explicitly denote its role as a data and logic provider. Consolidate or remove the placeholder `WorkflowExplorerView` from `view_explorer.go`, and create a proper `WorkflowExplorerView` component that consumes data from `WorkflowExplorerModel` and renders it using `tui.Renderer`.

### 145. credentialPatterns include overly broad regexes (e.g. generic long alphanumeric regexes) that will produce many false positives and may lead to noisy warnings.

**File**: `/Users/dshills/Development/projects/goflow/pkg/workflow/export.go:30`
**Severity**: Medium
**Category**: Security
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Narrow regex patterns and prioritize high-confidence signatures (provider-specific tokens, standard formats). Consider whitelisting known benign patterns or using entropy only as a secondary signal. Provide configuration for tuning/ignoring rules and add tests.

### 146. logBase2 function uses an incorrect approximation (returns x*0.5) which breaks entropy calculations used to detect high-entropy secrets, producing false negatives/positives.

**File**: `/Users/dshills/Development/projects/goflow/pkg/workflow/export.go:240`
**Severity**: Medium
**Category**: Security
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Replace the simplified approximation with a correct computation: use math.Log2 (or math.Log(x)/math.Log(2)) to compute log base 2. Recompute entropy with correct math functions and unit-test detection heuristics against known secret/non-secret strings.

### 147. deepCopyWorkflow performs only shallow copying for Variable.DefaultValue and comments note limitation; this may lead to accidental mutation of original workflow when nested complex types exist.

**File**: `/Users/dshills/Development/projects/goflow/pkg/workflow/export.go:420`
**Severity**: Medium
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Implement deep copy logic for DefaultValue based on type (or use encoding/gob, JSON marshal/unmarshal, or a generic deep-copy library) and add tests to ensure modifications to the copy don't affect the original.

### 148. extractVariableReferences performs a second brute-force pass over the entire expression for each candidate (nested loops over the expression string) which is O(n*m) and can be slow for large expressions.

**File**: `/Users/dshills/Development/projects/goflow/pkg/workflow/expression_validator.go:1`
**Severity**: Medium
**Category**: Performance
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use regex with word-boundary context or a single-pass parser to determine dotted identifiers vs base identifiers instead of repeated substring scanning. Add benchmarks and optimize for large expressions.

### 149. The `TransformNode.GetConfiguration` method includes several hardcoded fields (`value1`, `value2`, `value3`, `value4`, `message`, `name`, `id`) and assigns the node's `Expression` to them. The comment states this is 'For compatibility with tests that use generic config fields'. This is a hack for testing purposes that pollutes the configuration output with non-existent data, making `GetConfiguration` less accurate and harder to maintain. It violates the principle of representing the actual node's state.

**File**: `/Users/dshills/Development/projects/goflow/pkg/workflow/node.go:395`
**Severity**: Medium
**Category**: Style
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Remove the hardcoded, non-existent fields from `TransformNode.GetConfiguration()`. Update any tests that rely on these fields to use the correct `input_variable`, `expression`, and `output_variable` fields, ensuring tests use the actual configuration structure of the node.

### 150. AddEdge prevents duplicate edges solely by FromNodeID/ToNodeID pair which disallows adding multiple edges between the same nodes that differ by condition or label (e.g., conditional edges), preventing valid workflows using conditional branching.

**File**: `/Users/dshills/Development/projects/goflow/pkg/workflow/workflow.go:166`
**Severity**: Medium
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Include Condition and/or Label in the duplicate detection key (or allow multiple edges with the same from/to if they differ in condition/label). Update AddEdge tests and validation accordingly.

### 151. checkAllServers creates goroutines for concurrent health checks without limiting concurrency. Could cause resource exhaustion with many servers

**File**: `pkg/mcp/health.go:127`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add a semaphore or bounded goroutine pool to limit concurrent checks

### 152. Lock released before initialize but c.connected is set to true, creating a window where state could be inconsistent

**File**: `pkg/mcp/http_client.go:50`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Keep lock held until initialization completes, or use a separate connecting state flag

### 153. processSSEEvent silently ignores invalid JSON. Should at minimum increment an error counter or log

**File**: `pkg/mcp/sse_client.go:237`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Track or log invalid JSON parsing errors for debugging

### 154. G204 nosec comment provided but the security concern is valid. Command execution from user-configured settings needs validation

**File**: `pkg/mcp/stdio_client.go:100`
**Severity**: Medium
**Category**: Security
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add input validation at workflow validation time to ensure commands are in a whitelist or properly escaped

### 155. readResponses silently ignores invalid JSON lines. No logging or error tracking

**File**: `pkg/mcp/stdio_client.go:178`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Log or track invalid JSON for debugging connection issues

### 156. toLowerSimple reimplements unicode/strings package functionality. Should use strings.ToLower

**File**: `pkg/mcpserver/calltool.go:64`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Replace custom toLowerSimple with strings.ToLower from standard library

### 157. GetFrequentServers uses bubble sort O(nÂ²) instead of more efficient sorting algorithm

**File**: `pkg/mcpserver/connection_pool.go:85`
**Severity**: Medium
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use sort.Slice or similar standard library sorting for O(n log n) performance

### 158. cleanupIdle runs every 1 minute but keepAliveTime default is 5 minutes, creating potential for connections to exist 6 minutes total

**File**: `pkg/mcpserver/connection_pool.go:195`
**Severity**: Medium
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Align cleanup interval to be shorter than keep-alive time (e.g., 1 minute cleanup with 5 minute keep-alive is acceptable)

### 159. DiscoverTools creates new context from background() which ignores parent cancellation. Should accept context parameter

**File**: `pkg/mcpserver/server.go:241`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Accept context as parameter to DiscoverTools to respect caller's cancellation

### 160. InvokeTool creates new context from background() ignoring parent context. Should accept context parameter

**File**: `pkg/mcpserver/server.go:267`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Accept context as parameter to InvokeTool

### 161. HealthCheck creates new context from background() instead of accepting context parameter

**File**: `pkg/mcpserver/server.go:307`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Accept context as parameter to HealthCheck

### 162. File permissions 0755 for workflows directory is world-readable/executable. May expose sensitive workflows

**File**: `pkg/storage/filesystem.go:44`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use 0700 permissions for user-only access, or 0750 with restricted group

### 163. File permissions 0644 allows world-readable access to workflow files which may contain sensitive data

**File**: `pkg/storage/filesystem.go:63`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use 0600 permissions for user-only access

### 164. Silently ignoring errors in addToIndex/removeFromIndex could lead to inconsistent credential index state

**File**: `pkg/storage/keyring.go:89`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Return errors from Set/Delete methods if index update fails, or use separate repair mechanism

### 165. SetMaxOpenConns(1) for SQLite is correct but SetMaxIdleConns(1) may cause connection thrashing. Should be 0

**File**: `pkg/storage/sqlite.go:32`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use SetMaxIdleConns(0) to not keep idle connections open

### 166. Pre-allocating nodeExecs with capacity 32 is hardcoded assumption about workflow size

**File**: `pkg/storage/sqlite.go:250`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Make capacity configurable or use smaller default (e.g., 16) to avoid over-allocation

### 167. String operations (Contains, ToLower) used to detect error types instead of structured error checking. This is fragile and inefficient.

**File**: `pkg/transform/expression.go:89`
**Severity**: Medium
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use type assertions or wrapped errors (errors.As/errors.Is) to check error types properly.

### 168. Naive pattern matching for detecting infinite loops and long-running expressions (checking for 'while(true)' strings). This won't catch variations or actual problematic patterns.

**File**: `pkg/transform/expression.go:109`
**Severity**: Medium
**Category**: Style
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use a proper expression parser or rely on the timeout mechanism without compile-time pattern matching.

### 169. Program cache in exprEvaluator struct is not protected by mutex. Concurrent calls to Evaluate() can cause race conditions.

**File**: `pkg/transform/expression.go:160`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add sync.RWMutex to protect programCache from concurrent access.

### 170. JSONPath implementation handles many special cases (recursive descent, filters, wildcards, slicing) but lacks comprehensive error messages for unsupported patterns.

**File**: `pkg/transform/jsonpath.go:1`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add detailed error messages indicating which JSONPath features are not supported.

### 171. Multiple string scanning operations (validateBrackets, hasNegativeIndex, hasContainsFilter, etc.) iterate through the path string repeatedly. Each is O(n) and they're called sequentially.

**File**: `pkg/transform/jsonpath.go:195`
**Severity**: Medium
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Combine all validations into a single pass through the string to improve performance.

### 172. convertQuotesForGJSON manually parses strings with escape handling. Could miss edge cases. Not properly escaped sequences could cause injection.

**File**: `pkg/transform/jsonpath.go:400`
**Severity**: Medium
**Category**: Security
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use a proper JSON/string parser or escaper library.

### 173. Recursive findRecursive function has no depth limit, could cause stack overflow on deeply nested JSON structures.

**File**: `pkg/transform/jsonpath.go:654`
**Severity**: Medium
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add a maximum recursion depth parameter and return an error if exceeded.

### 174. handleWildcardQuery recursively calls itself without depth limiting. Could cause issues with deeply nested wildcard patterns.

**File**: `pkg/transform/jsonpath.go:760`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Track recursion depth and limit it to prevent stack overflow.

### 175. Template renderer is documented as not thread-safe, but no synchronization primitives are used. Configuration methods should use locks if concurrent access is possible.

**File**: `pkg/transform/template.go:38`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add mutex for thread-safe configuration changes or enforce that configuration only happens before concurrent use.

### 176. smartSplitArgs performs character-by-character iteration with rune conversion. Could use strings.Split with better pre-processing.

**File**: `pkg/transform/template.go:180`
**Severity**: Medium
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Optimize string splitting logic or use a third-party parser for template arguments.

### 177. ToInt has redundant uint overflow check. It checks if uint > max int64, but uint cannot be larger than uint64 max. Better to check the uint64 case.

**File**: `pkg/transform/type_conversion.go:130`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Simplify by removing unreachable code path or clarify intent with comments.

### 178. Error from screen.Close() in defer is silently ignored. Cleanup errors should at least be logged.

**File**: `pkg/tui/app.go:127`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Capture and log/return the close error instead of ignoring it.

### 179. Keyboard input goroutine uses blocking read on stdin with SetReadDeadline in a tight loop. This pattern can cause high CPU usage.

**File**: `pkg/tui/app.go:160`
**Severity**: Medium
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use a proper event-driven input mechanism or channel-based communication instead of polling with timeouts.

### 180. parseKeyInput hardcodes escape sequence parsing. Arrow keys are handled but function keys and other sequences are not.

**File**: `pkg/tui/app.go:185`
**Severity**: Medium
**Category**: Style
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use a robust terminal input library like tcell or similar that handles all escape sequences properly.

### 181. updateFilter iterates through all items on every search query change. No debouncing or incremental update.

**File**: `pkg/tui/components/list.go:175`
**Severity**: Medium
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add debouncing for search updates or implement incremental filtering.

### 182. watchEvents goroutine does not properly handle channel closure. If eventChan is closed externally, the loop will panic.

**File**: `pkg/tui/execution_monitor.go:180`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Check for closed channel: use `if !ok { return }` pattern.

### 183. renderNodeTree uses recursive approach without depth limiting. Could have issues with complex graphs.

**File**: `pkg/tui/execution_monitor.go:350`
**Severity**: Medium
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add recursion depth limit or use iterative approach with a stack.

### 184. GetRecentFrameTimes allocates new slice and copies data on every call. Could be optimized with circular buffer.

**File**: `pkg/tui/execution_monitor_panels.go:450`
**Severity**: Medium
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use a circular buffer or lazy evaluation pattern.

### 185. Multi-key sequence handling (pendingKey) can have race conditions if HandleKey is called from multiple goroutines.

**File**: `pkg/tui/keyboard.go:200`
**Severity**: Medium
**Category**: Style
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
The mutex protects pendingKey, but the timeout for sequences is not managed. Add sequence timeout handling.

### 186. keyEventFromString uses EqualFold comparison but doesn't trim whitespace from keyPart, could lead to unexpected failures.

**File**: `pkg/tui/keyboard.go:247`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add strings.TrimSpace call on keyPart before parsing.

### 187. StartCPUProfile doesn't defer cleanup. If an error occurs after StartCPUProfile but before StopCPUProfile is called, profiling continues indefinitely.

**File**: `pkg/tui/profiler.go:380`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use defer pprof.StopCPUProfile() or ensure proper error handling.

### 188. Helper functions min() and max() are implemented at file level when they could use math package functions

**File**: `pkg/tui/renderer.go:0`
**Severity**: Medium
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use math.Min() and math.Max() from the standard library, or move to a utilities package

### 189. loadServers() called on every Init() and multiple times during operation; no caching or debouncing of repeated calls

**File**: `pkg/tui/server_registry.go:282`
**Severity**: Medium
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Implement caching with TTL or only load when explicitly requested by user

### 190. Goroutine spawned with context created inside the goroutine; should be created outside and passed in

**File**: `pkg/tui/server_registry.go:342`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Create context.WithTimeout() before spawning goroutine and pass it as parameter

### 191. Multiple fields using empty string as sentinel value (keyEnabled map entries); no clear documentation of meaning

**File**: `pkg/tui/workflow_builder.go:163`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use explicit enum or constants to represent state, add documentation explaining state meanings

### 192. SelectNode() iterates through all nodes linearly to check existence; no index maintained

**File**: `pkg/tui/workflow_builder.go:197`
**Severity**: Medium
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Maintain a map of node IDs to allow O(1) lookup

### 193. selectNextNode() and selectPreviousNode() use keyEnabled flags with complex state tracking logic; behavior is non-obvious

**File**: `pkg/tui/workflow_builder.go:282`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Refactor navigation logic with clearer semantics or add documentation explaining the state machine

### 194. logBase2() function uses simplified approximation (x * 0.5) instead of proper logarithm calculation

**File**: `pkg/workflow/export.go:56`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use math.Log2() from standard library for accurate logarithm calculation

### 195. isHighEntropyString() entropy calculation simplified; may not accurately detect all credential patterns

**File**: `pkg/workflow/export.go:96`
**Severity**: Medium
**Category**: Security
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Implement proper Shannon entropy calculation or use established secret detection libraries

### 196. deepCopyWorkflow() performs shallow copy of Variable.DefaultValue with comment acknowledging the limitation

**File**: `pkg/workflow/export.go:188`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Implement deep copy for DefaultValue based on its concrete type, or document the limitation in API

### 197. extractVariableReferences() performs regex matching and string scanning separately; could be combined

**File**: `pkg/workflow/expression_validator.go:91`
**Severity**: Medium
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Combine operations into single pass through the expression

### 198. removeStringLiterals() iterates through expression character by character; inefficient for large expressions

**File**: `pkg/workflow/expression_validator.go:125`
**Severity**: Medium
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use regex pattern matching for more efficient string literal removal

### 199. validateExpressionSyntax() catches and filters errors broadly (mismatched types, undefined); may hide real syntax errors

**File**: `pkg/workflow/expression_validator.go:240`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Be more precise about which errors to ignore; document expected error types

### 200. Parse() function skips validation with comment stating it's by design, but no corresponding call to Validate() in typical usage

**File**: `pkg/workflow/parser.go:0`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Document when Validate() must be called explicitly; consider adding a ValidatingParse() function

### 201. validateParameterReferences() recursively checks config values; performance degrades with deeply nested structures

**File**: `pkg/workflow/template.go:217`
**Severity**: Medium
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Implement iterative approach using stack instead of recursion, or add depth limit

### 202. substituteValue() recursively substitutes parameters in nested structures; no limit on recursion depth

**File**: `pkg/workflow/template.go:339`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add maximum depth limit to prevent stack overflow on malicious input

### 203. Generic node wrappers (GenericMCPToolNode, etc.) have incomplete Validate() that doesn't check all required fields

**File**: `pkg/workflow/template.go:500`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Implement complete validation for all required fields in generic wrappers

### 204. Multiple string validation functions use strings.Contains() in loops against multiple patterns; could use regex or trie

**File**: `pkg/workflow/validator.go:0`
**Severity**: Medium
**Category**: Performance
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Compile patterns into single regex or use more efficient data structure for pattern matching

### 205. checkForOrphanedNodes() has complex adjacency building logic for ParallelNode and LoopNode; duplicated elsewhere

**File**: `pkg/workflow/workflow.go:228`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Extract adjacency building into separate helper function to avoid duplication

### 206. validateConditionExpression() extracts variable references and checks if defined, but doesn't validate variable types match expected boolean result

**File**: `pkg/workflow/workflow.go:275`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add type checking to ensure condition variables can be evaluated as booleans

### 207. showDeleteConfirmation() creates modal twice if callback is not registered; unreachable code path

**File**: `pkg/workflow/workflow_explorer.go:133`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Refactor logic to create modal only once with clear conditional flow

### 208. showRenameDialog() calls callback twice if registered; first call's return value is used as new name but discarded

**File**: `pkg/workflow/workflow_explorer.go:179`
**Severity**: Medium
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Capture callback result on first call and use that for rename operation

---

## Low Priority Issues (48)

### 209. Using os.Exit(0) inside a signal handler goroutine prevents other defer calls in the main function from executing. While cancel() is called before os.Exit(0) in this specific code, it's generally better practice for the main goroutine to exit gracefully after receiving the signal, allowing all deferred functions to execute. This requires cli.Execute() to be context-aware.

**File**: `/Users/dshills/Development/projects/goflow/cmd/goflow/main.go:23`
**Severity**: Low
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 210. The mcpserver.NewMCPServer calls create server instances (likely child processes) but they are not explicitly stopped or closed. In a real application, this could lead to resource leaks if the server processes are not terminated when no longer needed. While pool.Close() handles connections, it doesn't manage the lifecycle of the mcpserver.MCPServer instances themselves. This is acceptable for an example, but would be an issue in production.

**File**: `/Users/dshills/Development/projects/goflow/examples/performance_optimization_example.go:95`
**Severity**: Low
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 211. getTestServerPath constructs a source file path using runtime.Caller and returns an error mentioning a hard-coded relative path which may be confusing if the project layout differs.

**File**: `/Users/dshills/Development/projects/goflow/internal/testutil/testserver.go:8`
**Severity**: Low
**Category**: Style
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Make the error message more generic or include both the resolved path and a suggestion to run 'go test ./...' or check working directory. Consider locating the compiled test server binary instead of source main.go at runtime.

### 212. The credential overwrite confirmation uses fmt.Fscanln(os.Stdin, &response) directly, bypassing the cmd.InOrStdin() method. While os.Stdin often points to the same underlying file descriptor, using cmd.InOrStdin() ensures consistency and better testability of the command.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/credential.go:156`
**Severity**: Low
**Category**: Style
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 213. The hasCredentialEnvVars function relies on a fixed list of sensitivePatterns and substring checks (strings.Contains). While a good best-effort, this method is not foolproof. Malicious or poorly named environment variables might not be caught, and legitimate non-sensitive variables containing these substrings could be falsely flagged. This could lead to a false sense of security regarding the stripping of sensitive data.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/export.go:170`
**Severity**: Low
**Category**: Security
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 214. The error handling in runE for import contains a potentially redundant check for MissingServerError. After an initial errors.As(err, &missingServerErr) block, there's another else if errors.As(err, &missingErr) block that specifically notes it's 'already handled above.' This indicates dead code or an overly complex error handling structure.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/import.go:105`
**Severity**: Low
**Category**: Style
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 215. The GetConfigDir() function duplicates logic from initConfig() by re-checking GOFLOW_CONFIG_DIR and os.UserHomeDir every time it's called. This is inefficient and makes GlobalConfig.ConfigDir less of a single source of truth for the configuration path after initialization.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/root.go:80`
**Severity**: Low
**Category**: Performance
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 216. The splitKeyValue function manually searches for the first '=' to split key-value pairs. The standard library function strings.SplitN(s, "=", 2) is more idiomatic, potentially more efficient, and directly achieves the desired behavior of splitting only on the first occurrence of the separator, which is crucial if the value itself contains an '=' sign.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/run.go:178`
**Severity**: Low
**Category**: Style
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 217. runWithTUI uses a fixed sleep (time.Sleep(100 * time.Millisecond)) to wait for the execution monitor to become available, which is a race-prone approach.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/run.go:268`
**Severity**: Low
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use synchronization primitives or a channel/notification from the engine to wait until the monitor is ready instead of an arbitrary sleep. Polling with backoff or a wait-for-ready API is preferable.

### 218. The error returned by json.MarshalIndent is ignored in displayFinalResult and displayJSONResult. If exec.ReturnValue contains types that cannot be marshaled to JSON (e.g., channels, functions), this could lead to returnJSON being empty or containing a generic error string, potentially obscuring issues without explicit error handling.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/run.go:353`
**Severity**: Low
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 219. isValidServerID function could be replaced with regexp.MustCompile at package level for better performance if called frequently

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/server.go:108`
**Severity**: Low
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Compile the regex pattern once at package initialization instead of on every call

### 220. The hasCredentialPlaceholder function uses simple string matching (Contains, HasPrefix) for common placeholder patterns (e.g., {{, ${, <, $). This is a heuristic that can lead to false positives (legitimate values accidentally matching a pattern) or false negatives (custom placeholder formats not being detected). It's not a robust parser for all possible templating or environment variable syntaxes.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/workflow_import.go:154`
**Severity**: Low
**Category**: Security
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 221. In nodeMapToNode, for mcp_tool nodes, node.Parameters are converted to map[string]string by using fmt.Sprintf("%v", v). This implicitly converts all parameter values to strings, regardless of their original YAML type (e.g., numbers, booleans, other objects). This might lead to unexpected behavior or runtime errors if the downstream MCP tool expects specific native types for its parameters.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/workflow_loader.go:110`
**Severity**: Low
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 222. deepCopyValue has multiple type assertions for numeric slices ([]int, []float64) but doesn't handle all numeric types consistently. Missing []int64, []uint, etc.

**File**: `/Users/dshills/Development/projects/goflow/pkg/domain/execution/context.go:148`
**Severity**: Low
**Category**: Best Practices
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Either document supported types or use a more generic approach for numeric slices

### 223. Retry event timestamps are estimated by subtracting whole seconds from nodeExec.StartedAt which can produce timestamps earlier than actual events or out-of-order events.

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/audit.go:1`
**Severity**: Low
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Record real retry timestamps when retries occur, or store retry metadata (count + deltas) rather than guessing timestamps. If estimation is necessary, document the approximation.

### 224. formatValue uses json.MarshalIndent with a non-empty prefix and a small indent (json.MarshalIndent(v, "    ", "  ")) which is unusual and likely inconsistent formatting.

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/error.go:1`
**Severity**: Low
**Category**: Style
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use json.MarshalIndent(v, "", "  ") or a clearly documented prefix/indent combination. Add tests to ensure the pretty-printed output is as expected.

### 225. Tight coupling to concrete storage implementation: Logger depends on storage.SQLiteExecutionRepository concrete type instead of an interface, reducing testability and flexibility.

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/logger.go:1`
**Severity**: Low
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Depend on an interface (e.g., ExecutionRepository) rather than a concrete implementation. Inject the interface into Logger to allow mocks and alternative storage backends.

### 226. convertToSlice handles several concrete slice types but will error for other common collection types (e.g., []int64, []uint) and custom iterables; the error message uses %T which may be surprising to callers.

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/loop.go:1`
**Severity**: Low
**Category**: Style
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Either accept a broader set of types, use reflection to convert slices generically, or document supported types. Consider returning a more actionable error message.

### 227. Non-seeded pseudo-random jitter: calculateDelay uses math/rand.Float64() but the package's global RNG may not be seeded, resulting in deterministic jitter across runs.

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/retry.go:1`
**Severity**: Low
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Seed the default rand source at program start (rand.Seed(time.Now().UnixNano())) or better, use a rand.Source stored per RetryExecutor to avoid global state and to make behavior testable.

### 228. calculateDelay performs jitter multiplication and then applies MaxDelay ceiling after jitter; this can bias the distribution and may be surprising. Additionally, no guard against extremely large delays when converting float64 to time.Duration.

**File**: `/Users/dshills/Development/projects/goflow/pkg/execution/retry.go:1`
**Severity**: Low
**Category**: Style
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Apply the max delay before adding jitter, or clamp the resulting duration safely and document behavior. Consider using integer arithmetic to avoid float rounding issues.

### 229. The error handling logic (incrementing `FailedCheckCount`, setting `LastError`, marking `IsHealthy` based on `MaxFailedChecks`) is duplicated in `performHealthCheck` and `recordFailure`. This violates the DRY principle.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/health.go:139`
**Severity**: Low
**Category**: Style
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Refactor `performHealthCheck` to call `recordFailure` or a similar helper function for both connection errors and ping errors, simplifying its logic and avoiding duplication.

### 230. The `Connect` method unlocks the mutex (`c.mu.Unlock()`) before calling `c.initialize(ctx)`. If `initialize` fails, `c.connected` is reset to `false` inside a new lock. During the unlocked window, another goroutine calling `Connect` would see `c.connected` as true and return "already connected", even though the connection might eventually fail. This can lead to a false positive connection status.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/http_client.go:44`
**Severity**: Low
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Hold the mutex lock for the entire duration of the `Connect` method, including the call to `initialize`. If `initialize` is a long-running operation, consider refactoring `initialize` to manage its own concurrency or communicate its completion/failure through channels.

### 231. In the `initialize` method, when sending the 'initialized' notification, `_ = io.ReadAll(httpResp.Body)` ignores any potential errors during reading the HTTP response body. If the HTTP status is not 200/204/202 and the body reading itself fails, the error message might be misleading or incomplete.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/http_client.go:86`
**Severity**: Low
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Capture the error from `io.ReadAll` and include it in the `fmt.Errorf` message if `httpResp.StatusCode` is not one of the expected success codes (200, 204, 202). Alternatively, log the body read error for debugging purposes.

### 232. JSONRPCRequest.Params is declared as json.RawMessage but newRequest sets Params to a marshaled json.RawMessage; while valid, this can be confusing and may hide marshalling errors.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/jsonrpc.go:1`
**Severity**: Low
**Category**: Style
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Consider changing JSONRPCRequest.Params to interface{} and let encoding/json handle marshalling, or keep as json.RawMessage but document the intended usage clearly. Ensure errors from param marshalling are surfaced (they already are).

### 233. Similar to `HTTPClient.Connect`, the `Connect` method unlocks the mutex (`c.mu.Unlock()`) before calling `c.initialize(ctx)`. If `initialize` fails, `c.Close()` is called. During the unlocked window, another goroutine calling `Connect` would see `c.connected` as true and return "already connected", even if the initial connection eventually fails.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/sse_client.go:49`
**Severity**: Low
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Hold the mutex lock for the entire duration of the `Connect` method, including the call to `initialize`. If `initialize` is a long-running operation, consider refactoring `initialize` to manage its own concurrency or communicate its completion/failure through channels.

### 234. In `sendRequest` and `sendNotification`, `strings.NewReader(string(reqJSON))` converts a `[]byte` to a `string` and then creates a reader. This can lead to an unnecessary string allocation and memory copy. `bytes.NewReader(reqJSON)` is generally more efficient for `[]byte`.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/sse_client.go:154`
**Severity**: Low
**Category**: Performance
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Replace `strings.NewReader(string(reqJSON))` with `bytes.NewReader(reqJSON)` in both `sendRequest` and `sendNotification` for improved performance and reduced allocations.

### 235. Similar to HTTP/SSE clients, the `Connect` method unlocks the mutex (`c.mu.Unlock()`) before `initialize` is called. If `initialize` fails, `Close()` is called to reset the state. During the unlocked window, another `Connect` call might see `c.cmd != nil` and return "already connected" prematurely.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/stdio_client.go:39`
**Severity**: Low
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Hold the mutex lock for the entire duration of the `Connect` method, including the call to `initialize`. If `initialize` is a long-running operation, consider refactoring `initialize` to manage its own concurrency or communicate its completion/failure through channels.

### 236. sendRequest defers deletion of pendingRequests but does not guard against multiple deletes if the reader also removes the entry (rare race if both sides attempt deletion).

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/stdio_client.go:114`
**Severity**: Low
**Category**: Style
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Ensure a single owner of pendingRequests entries; consider leaving removal to a single path or check existence before delete. Use careful locking and deterministic lifecycle for pending entries.

### 237. Custom string-to-lower helpers (toLowerSimple and containsSubstring) reimplement standard library functionality (strings.ToLower and strings.Contains) and use manual loops which are error-prone and less readable.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcpserver/calltool.go:1`
**Severity**: Low
**Category**: Style
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Replace toLowerSimple and containsSubstring with strings.ToLower and strings.Contains to improve readability and correctness (they handle Unicode appropriately, if desired).

### 238. In `ListTools`, if the `protocolClient` returns `[]interface{}`, the adapter performs a `json.Marshal` and `json.Unmarshal` roundtrip for each tool to convert it to the `Tool` struct. This can be inefficient due to multiple allocations and CPU cycles for serialization/deserialization, especially for many tools.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcpserver/client_adapter.go:95`
**Severity**: Low
**Category**: Performance
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
If `raw` is typically a `map[string]interface{}`, consider using a library like `mapstructure` or manually mapping fields from `map[string]interface{}` to the `Tool` struct instead of the JSON serialization roundtrip to improve performance.

### 239. In the `List` method, errors encountered while loading individual workflows are silently skipped with a comment `// In production, this would use a proper logger`. In a real application, these errors should be logged to aid debugging and prevent silent data loss or unexpected behavior.

**File**: `/Users/dshills/Development/projects/goflow/pkg/storage/filesystem.go:128`
**Severity**: Low
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Integrate a logging mechanism (e.g., `log` package or a structured logger) to log errors encountered during individual workflow loading in the `List` method, instead of silently continuing.

### 240. In `Set` and `Delete`, errors during `addToIndex` or `removeFromIndex` operations are silently ignored (`_ = err`), with a comment suggesting a proper logger. This can lead to an inconsistent or out-of-sync credential index without any indication of a problem, making future `List` operations incorrect.

**File**: `/Users/dshills/Development/projects/goflow/pkg/storage/keyring.go:45`
**Severity**: Low
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Integrate a logging mechanism (e.g., `log` package or a structured logger) to log errors encountered during credential index updates, providing better visibility into potential inconsistencies.

### 241. SQL queries for pagination append LIMIT/OFFSET numbers via fmt.Sprintf which is safe for ints but is less consistent than using SQL parameters. Using direct interpolation makes future refactors prone to injection mistakes if types change.

**File**: `/Users/dshills/Development/projects/goflow/pkg/storage/sqlite.go:44`
**Severity**: Low
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use prepared statements with parameters for LIMIT and OFFSET where supported, or at least validate/sanitize integer inputs before interpolation. Document that options.Limit/Offset are validated earlier.

### 242. The `Load` method eagerly loads all associated `NodeExecutions` for a given `ExecutionID`. If a workflow has a very large number of nodes, or if `Load` is called frequently in a performance-critical path, this eager loading could lead to excessive database queries and memory usage.

**File**: `/Users/dshills/Development/projects/goflow/pkg/storage/sqlite.go:204`
**Severity**: Low
**Category**: Performance
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Consider making `loadNodeExecutions` a separate, explicitly called method (e.g., `LoadNodeExecutionsForExecution(id types.ExecutionID)`) so that `Load` only retrieves top-level execution data. This would allow callers to decide when they need the detailed node information, enabling lazy loading.

### 243. There is duplicate error handling logic for `ErrUndefinedVariable` in both `Evaluate` (when `vm.Run` returns an error) and `getOrCompileProgram` (when `expr.Compile` returns an error). While `expr-lang` might return similar messages at different stages, centralizing the mapping of `expr-lang` specific errors to domain-specific errors could improve consistency and reduce code duplication. Also, `getOrCompileProgram` attempts to re-categorize compile errors for `while(true)` or `factorial(` as `ErrEvaluationTimeout`, which might be misleading if the error is purely a compilation syntax error, not a runtime timeout condition.

**File**: `/Users/dshills/Development/projects/goflow/pkg/transform/expression.go:70`
**Severity**: Low
**Category**: Style
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Consolidate error categorization logic where possible. Consider creating a helper function to map raw `expr-lang` errors to `transform` package errors consistently. Re-evaluate the logic that changes `ErrInvalidExpression` (from compilation) to `ErrEvaluationTimeout` based on string matching, ensuring it accurately reflects the nature of the error.

### 244. render sets lastFrameTime = start (a time.Time) but the variable name suggests it should store the frame duration or the last render completion time; this is confusing and may be incorrect for later performance tracking.

**File**: `/Users/dshills/Development/projects/goflow/pkg/tui/app.go:144`
**Severity**: Low
**Category**: Style
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Store the computed frameTime (duration) in an appropriately named field (e.g., lastFrameDuration) or set lastFrameTime = time.Now() if you intend to track the timestamp. Clarify naming and usage.

### 245. The `registerSequence` function explicitly limits sequences to 2 keys. While sufficient for 'gg', more complex Vim-style operations often involve 3 or more key sequences (e.g., `dap` for delete around paragraph, `ciw` for change inner word). This limitation might restrict future extensibility if more complex multi-key commands are desired.

**File**: `/Users/dshills/Development/projects/goflow/pkg/tui/default_bindings.go:234`
**Severity**: Low
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
If more complex multi-key sequences are anticipated, consider refactoring the `KeyboardHandler`'s sequence logic to support sequences of arbitrary length. This would involve a more generic state machine for sequence matching, rather than just a `pendingKey`.

### 246. The `HandleKey` method first checks `globalBindings` and then `mode-specific bindings`. For the `Escape` key, a `globalBinding` for `Escape` (`OnToggleHelp`) is registered in `app.go`, and a `ModeNormal` binding for `Escape` (`OnEnterNormalMode` if help is already closed) is registered in `default_bindings.go`. This means the `globalBinding` will always take precedence for `Escape`, potentially overriding the intended Vim-like behavior of `Escape` directly exiting `Insert` or `Command` mode to `Normal` mode. Instead, `Escape` from `Insert`/`Command` should ideally return to `Normal` (without toggling help), and `Escape` in `Normal` mode could toggle help/overlays. The current setup makes `Escape` universally toggle help first.

**File**: `/Users/dshills/Development/projects/goflow/pkg/tui/keyboard.go:139`
**Severity**: Low
**Category**: Style
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Re-evaluate the priority of global vs. mode-specific bindings, especially for common keys like `Escape`. A common Vim pattern is that `Escape` *always* drops you to Normal mode, and only in Normal mode would it have a secondary function like closing an overlay. Consider making the 'Escape to Normal mode' binding mode-specific to `ModeInsert`, `ModeVisual`, `ModeCommand`, and then have a global `Escape` that checks the *current mode* before deciding to toggle help or simply do nothing if already in Normal mode without overlays.

### 247. Renderer.EndFrame always calls profiler.EndFrame with a static ProfileToken{FrameID:0} which prevents distinguishing frames in profiler data.

**File**: `/Users/dshills/Development/projects/goflow/pkg/tui/renderer.go:300`
**Severity**: Low
**Category**: Best Practices
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use a proper frame counter or unique token per frame, or pass meaningful metadata to Profiler to make profiling data useful.

### 248. The `MarshalJSON` and `UnmarshalJSON` methods for `Edge` are explicitly defined but perform no custom logic beyond what Go's default JSON marshaller would do. This adds unnecessary boilerplate code.

**File**: `/Users/dshills/Development/projects/goflow/pkg/workflow/edge.go:34`
**Severity**: Low
**Category**: Style
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Remove the `MarshalJSON` and `UnmarshalJSON` methods for `Edge`. Go's default JSON marshaller will handle these types correctly without explicit implementation.

### 249. The `extractVariableReferences` function uses a heuristic approach (regex matching, string literal removal, and filtering dotted fields) to infer base variable names from expressions. While clever, heuristics can be brittle and might misinterpret complex expressions or break with future syntax changes in the expression language. A more robust solution typically involves parsing the expression into an Abstract Syntax Tree (AST) to reliably identify variable nodes.

**File**: `/Users/dshills/Development/projects/goflow/pkg/workflow/expression_validator.go:34`
**Severity**: Low
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
For a more robust and future-proof solution, consider integrating an AST parser for the expression language to accurately extract variable references. If full AST parsing is deemed too complex for the current needs, ensure extensive unit tests are in place to cover edge cases for the current heuristic, and document its limitations.

### 250. The `MarshalJSON` and `UnmarshalJSON` methods for `ServerConfig` are explicitly defined but perform no custom logic beyond what Go's default JSON marshaller would do. This adds unnecessary boilerplate code.

**File**: `/Users/dshills/Development/projects/goflow/pkg/workflow/server_config.go:105`
**Severity**: Low
**Category**: Style
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Remove the `MarshalJSON` and `UnmarshalJSON` methods for `ServerConfig`. Go's default JSON marshaller will handle these types correctly without explicit implementation.

### 251. formatValue uses reflect.ValueOf(v).Float() for float32/float64 but the code relies on reflect for number formatting; this is less clear than type-switch handling and may panic for unexpected numeric types.

**File**: `/Users/dshills/Development/projects/goflow/pkg/workflow/template.go:520`
**Severity**: Low
**Category**: Style
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use a clear type switch for numeric types and convert to float64 using standard conversions instead of reflect.Value where possible. Add tests to cover formatting of all supported numeric types.

### 252. While `NewWorkflowID()` and `NewEdgeID()` functions exist (generating UUIDs), there is no `NewNodeID()` function. Node IDs are generated inconsistently in other parts of the codebase (e.g., `workflow_builder.go` uses `fmt.Sprintf` with sequential numbers, which is less robust for uniqueness and predictability).

**File**: `/Users/dshills/Development/projects/goflow/pkg/workflow/types.go:23`
**Severity**: Low
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add a `NewNodeID()` function to `pkg/workflow/types.go` that generates a UUID, similar to how `NewWorkflowID()` and `NewEdgeID()` are implemented. Update all node creation points (e.g., in `tui/workflow_builder.go` and `pkg/workflow/parser.go`) to consistently use `workflow.NewNodeID()` for robust and unique ID generation.

### 253. validateNoSuspiciousPatterns uses a static list of suspicious substrings which may produce false positives on benign content and is not internationalized; attackers could evade detection via obfuscation.

**File**: `/Users/dshills/Development/projects/goflow/pkg/workflow/validator.go:1`
**Severity**: Low
**Category**: Security
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Treat this as a heuristic only and avoid blocking based solely on these checks. Consider more sophisticated parsing or allow configurable patterns. Document and surface warnings rather than failing hard in non-critical paths.

### 254. The `MarshalJSON` and `UnmarshalJSON` methods for `Variable` are explicitly defined but perform no custom logic beyond what Go's default JSON marshaller would do. This adds unnecessary boilerplate code.

**File**: `/Users/dshills/Development/projects/goflow/pkg/workflow/variable.go:108`
**Severity**: Low
**Category**: Style
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Remove the `MarshalJSON` and `UnmarshalJSON` methods for `Variable`. Go's default JSON marshaller will handle these types correctly without explicit implementation.

### 255. The `MarshalJSON` method for `Workflow` is explicitly defined but performs no custom logic beyond what Go's default JSON marshaller would do. This adds unnecessary boilerplate code.

**File**: `/Users/dshills/Development/projects/goflow/pkg/workflow/workflow.go:481`
**Severity**: Low
**Category**: Style
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Remove the `MarshalJSON` method for `Workflow`. Go's default JSON marshaller will handle the `Workflow` struct correctly without explicit implementation.

### 256. TransformNode.GetConfiguration() populates generic config fields (value1-4, message, name, id) for test compatibility; couples implementation to tests

**File**: `pkg/workflow/node.go:0`
**Severity**: Low
**Category**: Style
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Remove test-specific code from production implementation; use test fixtures or factories instead

---

## Informational Issues (19)

### 257. Errors returned by client.Close() and server.Disconnect() in the cleanup functions (cleanup()) are ignored. While in many cleanup scenarios, especially defers, ignoring these is common, it can mask potential resource leakage or problems during shutdown. For a test utility, this is a minor detail.

**File**: `/Users/dshills/Development/projects/goflow/internal/testutil/testserver.go:78`
**Severity**: Info
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 258. The return values of fmt.Fprintf calls to s.stderr and s.stdout are consistently ignored. While write errors to stderr are often non-recoverable and ignored, for stdout in an RPC server, a write error could indicate a broken pipe, which might be worth logging or handling to ensure the client receives expected responses.

**File**: `/Users/dshills/Development/projects/goflow/internal/testutil/testserver/main.go:344`
**Severity**: Info
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 259. The limitedReader reads maxCredentialSize + 1 bytes to detect if the input exceeds the limit. However, inputBytes, err := io.ReadAll(limitedReader) will read up to this limit. If len(inputBytes) > maxCredentialSize is triggered, it means inputBytes already contains the oversized data. This is safe, but the +1 in LimitReader is primarily to detect overflow *after* reading, rather than to prevent reading it. No direct remediation needed as it's functional and safe.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/credential.go:192`
**Severity**: Info
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 260. The cmd.SetContext(cmd.Context()) call in PreRunE is redundant. A command's context is already set and accessible via cmd.Context(), so setting it to itself has no effect.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/executions.go:52`
**Severity**: Info
**Category**: Style
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 261. The code explicitly notes that automatic server configuration has been removed from templates due to supply-chain security risks associated with automatically downloading and executing remote code (e.g., via npx). This is a crucial and commendable security improvement.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/init.go:204`
**Severity**: Info
**Category**: Security
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 262. The GlobalConfig is exposed as a package-level global variable. While common in CLI applications, excessive use of global state can make code harder to test, reason about, and refactor in larger applications.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/root.go:40`
**Severity**: Info
**Category**: Style
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 263. The isValidServerID function manually iterates through characters to validate the server ID. Using regexp.MatchString (e.g., regexp.MatchString("^[a-zA-Z0-9_-]+$", id)) would be more concise and consistent with other validation functions like isValidWorkflowName.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/server.go:393`
**Severity**: Info
**Category**: Style
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 264. The NewValidateCommand explicitly reports "All nodes reachable" and "No circular dependencies" as separate success messages after wf.Validate() has already been called. The wf.Validate() method already encompasses these checks. While providing explicit feedback is useful, it introduces some redundancy in validation logic and reporting.

**File**: `/Users/dshills/Development/projects/goflow/pkg/cli/validate.go:94`
**Severity**: Info
**Category**: Style
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 265. The GetCurrentNode method is explicitly documented as an alias for CurrentNode for backward compatibility. While harmless, aliases add slight confusion and maintenance burden.

**File**: `/Users/dshills/Development/projects/goflow/pkg/domain/execution/context.go:218`
**Severity**: Info
**Category**: Style
**Providers**: google
**Consensus**: 1/3 providers (33%)


### 266. Malformed JSON-RPC responses received via Server-Sent Events (SSE) are silently skipped in `processSSEEvent`. While preventing a crash, this lack of logging or error reporting could make debugging issues with the MCP server or the connection difficult.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/sse_client.go:204`
**Severity**: Info
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add logging for malformed JSON events within `processSSEEvent` to provide visibility into parsing failures. For example, `log.Printf("SSE: Failed to unmarshal JSON-RPC response: %v, data: %s", err, data)`.

### 267. Malformed JSON-RPC responses from `stdout` are silently skipped in `readResponses`. This can make debugging communication issues with the MCP server process difficult.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcp/stdio_client.go:139`
**Severity**: Info
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add logging for malformed JSON events within `readResponses` to provide visibility into parsing failures. For example, `log.Printf("Stdio: Failed to unmarshal JSON-RPC response: %v, data: %s", err, string(line))`.

### 268. The error message for 'tool not found' uses `%v` to display `availableTools`, which prints the slice in its default Go format (e.g., `[tool1 tool2]`). This might not be the most user-friendly or readable format for end-users.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcpserver/calltool.go:56`
**Severity**: Info
**Category**: Style
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Use `strings.Join(availableTools, ", ")` to present a comma-separated list of available tools for better readability in the error message.

### 269. In `cleanupIdle`, the error returned by `conn.Server.Disconnect()` is ignored (`_ = conn.Server.Disconnect()`). While often tolerated in cleanup routines, logging such errors could provide valuable debugging information if connections fail to close gracefully.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcpserver/connection_pool.go:328`
**Severity**: Info
**Category**: Best Practices
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Log the error returned by `conn.Server.Disconnect()` if it is not `nil`, to help diagnose issues with connection teardown.

### 270. The `NewMCPServer` function reuses the `command` parameter to pass a URL when `transportType` is `TransportSSE` or `TransportHTTP`. This is functionally correct but can be misleading as 'command' typically suggests an executable path.

**File**: `/Users/dshills/Development/projects/goflow/pkg/mcpserver/server.go:64`
**Severity**: Info
**Category**: Style
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Consider a `NewMCPServer` variant or a refined `ServerConfig` struct that explicitly separates the executable `Command` from a `URL` or `BaseURL` field, making the intent clearer for different transport types.

### 271. The dirty region coalescing in `markDirtyInternal` uses a nested loop (`for j := i + 1; j < len(r.dirtyRegions);`) after a union operation. While unlikely to be a bottleneck for typical TUI usage (small number of dirty regions), for a very large number of overlapping dirty regions, this `O(N^2)` approach could be inefficient. For a general-purpose renderer, a spatial data structure (like a quadtree) would be more performant for very high numbers of dirty regions, but for TUI, this is usually acceptable.

**File**: `/Users/dshills/Development/projects/goflow/pkg/tui/renderer.go:154`
**Severity**: Info
**Category**: Performance
**Providers**: google
**Consensus**: 1/3 providers (33%)

**Remediation**:
Consider documenting the expected scale of `dirtyRegions` and if it grows significantly, explore more advanced data structures for collision detection and union operations, such as a quadtree or k-d tree. For typical TUI use cases, this is likely acceptable.

### 272. Many exported methods and fields in view builder and related types are not documented or have inconsistent receiver naming and visibility (e.g., mixed pointer/value receivers), which may reduce maintainability.

**File**: `/Users/dshills/Development/projects/goflow/pkg/tui/view_builder.go:1`
**Severity**: Info
**Category**: Style
**Providers**: openai
**Consensus**: 1/3 providers (33%)

**Remediation**:
Add GoDoc comments for exported types and functions, ensure consistent receiver styles, and run golint/go vet to surface style issues. Consider reducing visibility for internals.

### 273. WorkflowBuilderView has TODO comments indicating incomplete implementation (vim-style navigation, keyboard input handling)

**File**: `pkg/tui/view_builder.go:0`
**Severity**: Info
**Category**: Style
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Complete the implementation or add test placeholders

### 274. WorkflowExplorerView has TODO comments indicating incomplete implementation (keyboard navigation, search mode)

**File**: `pkg/tui/view_explorer.go:0`
**Severity**: Info
**Category**: Style
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Complete the implementation or add test placeholders

### 275. ExecutionMonitorView has TODO comments indicating incomplete implementation (keyboard navigation, refresh)

**File**: `pkg/tui/view_monitor.go:0`
**Severity**: Info
**Category**: Style
**Providers**: anthropic
**Consensus**: 1/3 providers (33%)

**Remediation**:
Complete the implementation or add test placeholders

---

## Files Reviewed

### Files with Issues

- `/Users/dshills/Development/projects/goflow/cmd/goflow/main.go` - 3 issue(s)
- `/Users/dshills/Development/projects/goflow/cmd/validate-template/main.go` - 2 issue(s)
- `/Users/dshills/Development/projects/goflow/examples/performance_optimization_example.go` - 2 issue(s)
- `/Users/dshills/Development/projects/goflow/internal/testutil/testserver.go` - 3 issue(s)
- `/Users/dshills/Development/projects/goflow/internal/testutil/testserver/main.go` - 7 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/cli/credential.go` - 10 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/cli/executions.go` - 3 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/cli/export.go` - 3 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/cli/import.go` - 2 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/cli/init.go` - 2 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/cli/logs.go` - 5 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/cli/root.go` - 3 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/cli/run.go` - 7 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/cli/server.go` - 2 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/cli/validate.go` - 1 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/cli/workflow_import.go` - 2 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/cli/workflow_loader.go` - 3 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/domain/execution/context.go` - 5 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/domain/execution/execution.go` - 2 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/domain/execution/types.go` - 1 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/execution/audit.go` - 3 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/execution/cache.go` - 6 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/execution/error.go` - 4 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/execution/events.go` - 2 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/execution/logger.go` - 2 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/execution/loop.go` - 2 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/execution/node_executor.go` - 3 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/execution/parallel.go` - 1 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/execution/progress.go` - 1 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/execution/retry.go` - 5 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/execution/runtime.go` - 4 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/execution/snapshot.go` - 3 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/mcp/connection_pool.go` - 4 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/mcp/health.go` - 3 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/mcp/http_client.go` - 4 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/mcp/jsonrpc.go` - 2 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/mcp/sse_client.go` - 6 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/mcp/stdio_client.go` - 6 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/mcpserver/calltool.go` - 3 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/mcpserver/client_adapter.go` - 1 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/mcpserver/connection_pool.go` - 4 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/mcpserver/server.go` - 1 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/storage/filesystem.go` - 3 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/storage/keyring.go` - 2 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/storage/sqlite.go` - 2 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/transform/expression.go` - 7 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/transform/jsonpath.go` - 4 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/transform/template.go` - 1 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/transform/transform.go` - 1 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/transform/type_conversion.go` - 1 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/tui/app.go` - 3 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/tui/default_bindings.go` - 1 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/tui/execution_monitor.go` - 1 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/tui/keyboard.go` - 3 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/tui/keyboard_utils.go` - 1 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/tui/profiler.go` - 1 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/tui/renderer.go` - 4 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/tui/server_registry.go` - 5 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/tui/view_builder.go` - 1 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/tui/workflow_builder.go` - 2 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/tui/workflow_explorer.go` - 1 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/workflow/edge.go` - 1 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/workflow/export.go` - 5 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/workflow/expression_validator.go` - 2 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/workflow/node.go` - 1 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/workflow/server_config.go` - 1 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/workflow/template.go` - 1 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/workflow/types.go` - 1 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/workflow/validator.go` - 2 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/workflow/variable.go` - 1 issue(s)
- `/Users/dshills/Development/projects/goflow/pkg/workflow/workflow.go` - 3 issue(s)

### Clean Files (No Issues)

- `/Users/dshills/Development/projects/goflow/pkg/cli/colors.go`
- `/Users/dshills/Development/projects/goflow/pkg/cli/edit.go`
- `/Users/dshills/Development/projects/goflow/pkg/domain/execution/node_execution.go`
- `/Users/dshills/Development/projects/goflow/pkg/domain/execution/repository.go`
- `/Users/dshills/Development/projects/goflow/pkg/domain/execution/variable_snapshot.go`
- `/Users/dshills/Development/projects/goflow/pkg/domain/types/types.go`
- `/Users/dshills/Development/projects/goflow/pkg/execution/error_integration_example.go`
- `/Users/dshills/Development/projects/goflow/pkg/mcp/types.go`
- `/Users/dshills/Development/projects/goflow/pkg/mcpserver/client_integration.go`
- `/Users/dshills/Development/projects/goflow/pkg/mcpserver/connection.go`
- `/Users/dshills/Development/projects/goflow/pkg/mcpserver/repository.go`
- `/Users/dshills/Development/projects/goflow/pkg/mcpserver/tool.go`
- `/Users/dshills/Development/projects/goflow/pkg/mcpserver/tool_schema.go`
- `/Users/dshills/Development/projects/goflow/pkg/mcpserver/types.go`
- `/Users/dshills/Development/projects/goflow/pkg/storage/migrations.go`
- `/Users/dshills/Development/projects/goflow/pkg/transform/errors.go`
- `/Users/dshills/Development/projects/goflow/pkg/tui/components/button.go`
- `/Users/dshills/Development/projects/goflow/pkg/tui/components/list.go`
- `/Users/dshills/Development/projects/goflow/pkg/tui/components/modal.go`
- `/Users/dshills/Development/projects/goflow/pkg/tui/components/panel.go`
- `/Users/dshills/Development/projects/goflow/pkg/tui/components/statusbar.go`
- `/Users/dshills/Development/projects/goflow/pkg/tui/examples/condition_example.go`
- `/Users/dshills/Development/projects/goflow/pkg/tui/execution_monitor_panels.go`
- `/Users/dshills/Development/projects/goflow/pkg/tui/keyboard_doc.go`
- `/Users/dshills/Development/projects/goflow/pkg/tui/view_explorer.go`
- `/Users/dshills/Development/projects/goflow/pkg/tui/view_monitor.go`
- `/Users/dshills/Development/projects/goflow/pkg/tui/views.go`
- `/Users/dshills/Development/projects/goflow/pkg/workflow/parser.go`
- `/Users/dshills/Development/projects/goflow/pkg/workflow/repository.go`

---

## Provider Details

### Anthropic

- **Status**: Success âœ“
- **Issues Found**: 126
- **Tokens Used**: 319,461
- **Duration**: 2m 13s

### Google

- **Status**: Success âœ“
- **Issues Found**: 72
- **Tokens Used**: 373,383
- **Duration**: 8m 34s

### Openai

- **Status**: Success âœ“
- **Issues Found**: 77
- **Tokens Used**: 264,211
- **Duration**: 6m 37s

---

## Review Timeline

- **Started**: 2025-11-12T06:23:10-06:00
---

Generated by Multi-LLM Code Review Workflow
